---
title: "An√°lisis de Series de Tiempo y Pron√≥st√≥sticos ARIMA"
subtitle: "Estudio Emp√≠rico sobre el Precio de Acciones de Tesla Inc."
author: "Camilo"
date: "`r format(Sys.Date(), '%d de %B de %Y')`"
output:
  html_document:
    theme: darkly
    toc: false         
    toc_float: false   
---



<div id="custom-toc"></div>


```{=html}
<style type="text/css">


/* ========== PALETA DE COLORES CLARA - EST√âTICA PROFESIONAL Y DIN√ÅMICA ========== */
@import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&family=Poppins:wght@500;600;700&display=swap');

html, body {
  font-family: 'Inter', system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif !important;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}
h1, h2, h3 {
  font-family: 'Poppins', 'Inter', sans-serif !important;
  letter-spacing: -0.02em;
}
:root {
  /* Colores Base */
  --bg-light: #ffffff;
  --bg-lighter: #f5f7fa;
  --text-dark: #1f2937;
  --text-medium: #4b5563;
  --text-gray: #94a3b8;

  /* Acentos QQQ: Cian/Verde */
  --accent-primary: #00b894;
  --accent-secondary: #06b6d4;
  --accent-positive: #84cc16;
  --accent-negative: #e17055;
  --accent-soft: #3b82f6;
}

/* ========== RESET & ESTRUCTURA CLAVE ========== */
* {
  box-sizing: border-box !important;
  margin: 0;
  padding: 0;
}

html, body {
  background: var(--bg-light) !important;
  color: var(--text-dark) !important;
  font-family: 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif !important;
  line-height: 1.65 !important;
  overflow-x: hidden !important;
  min-height: 100vh !important;
}

/* Contenedor de contenido central */
div.container-fluid:first-of-type {
  width: auto !important;
  max-width: 100% !important;
  padding: 60px 80px !important;
}

/* ========== TOC PERSONALIZADO "CONTENIDO" ========== */
/* ========== TOC PERSONALIZADO "CONTENIDO" ========== */
#custom-toc {
  position: fixed;
  top: 60px;
  left: 0;
  width: 260px;
  height: 80vh;
  /* CAMBIOS IMPORTANTES AQU√ç: */
  display: flex;              /* Usar flexbox para organizar hijos */
  flex-direction: column;     /* Uno debajo del otro */
  overflow: hidden;           /* El contenedor NO scrollea, solo sus hijos */
  /* Fin de cambios */
  padding: 0;                 /* Quitamos padding general para manejarlo dentro */
  background: var(--bg-lighter);
  border-right: 2px solid var(--accent-secondary);
  border-radius: 0 10px 10px 0;
  box-shadow: 0 4px 20px rgba(0,0,0,0.15);
  z-index: 999;
}

/* T√≠tulo del TOC */
#custom-toc h2 {
  position: relative;
  flex-shrink: 0;
  background: var(--bg-lighter);
  z-index: 10;
  /* CAMBIO AQU√ç: Reduje el padding superior de 20px a 10px */
  padding: 10px 15px 15px 15px; 
  margin: 0;
  border-bottom: 2px solid rgba(0, 184, 148, 0.3);
  box-shadow: 0 4px 6px -1px rgba(0,0,0,0.05); /* Sombra sutil para separar */
}

/* dar espacio despu√©s del t√≠tulo */
/* Lista de enlaces (Aqu√≠ ocurre el scroll) */
#custom-toc ul {
  list-style: none !important;
  /* CAMBIO AQU√ç: El primer valor (arriba) ahora es 0px */
  padding: 0px 10px 20px 10px !important; 
  margin: 0 !important;
  flex-grow: 1;               
  overflow-y: auto;           
  
  scrollbar-width: thin;
  scrollbar-color: var(--accent-secondary) transparent;
}

/* CAMBIO EXTRA: Asegura que el primer √≠tem suba al m√°ximo */
#custom-toc li:first-child {
  margin-top: 2px !important; /* Muy pegado arriba */
}

#custom-toc li {
  margin: 8px 0 !important;
}

/* Estilo de enlaces del TOC */
#custom-toc a {
  display: block;
  padding: 10px 14px;
  color: var(--text-medium) !important;
  text-decoration: none;
  border-radius: 8px;
  transition: all .2s ease;
}

#custom-toc a:hover {
  background: rgba(0,184,148,0.15);
  color: var(--accent-primary) !important;
  transform: translateX(5px);
  box-shadow: 0 4px 14px rgba(0,0,0,0.12);
}

/* Enlace activo */
#custom-toc a.active {
  background: var(--bg-light);
  color: var(--accent-primary) !important;
  border-left: 5px solid var(--accent-secondary);
  font-weight: 600;
  transform: translateX(4px);
}

/* Scrollbar est√©tico */
#custom-toc::-webkit-scrollbar {
  width: 6px !important;
}

#custom-toc::-webkit-scrollbar-thumb {
  background: var(--accent-secondary) !important;
  border-radius: 10px !important;
}

/* Ocultar el TOC nativo de R Markdown */
#TOC {
  display: none !important;
}

/* ========== SECCIONES Y TIPOGRAF√çA ========== */
.section.level1 {
  margin-bottom: 80px !important;
  padding: 50px !important;
  background: var(--bg-light) !important;
  border: 1px solid rgba(0, 0, 0, 0.05) !important;
  border-top: 6px solid var(--accent-primary) !important;
  border-radius: 12px !important;
  box-shadow: 0 12px 40px rgba(0, 0, 0, 0.1) !important;
  transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1) !important;
}

.section.level1:hover {
  border-top-color: var(--accent-secondary) !important;
  box-shadow: 0 18px 55px rgba(0, 0, 0, 0.15) !important;
  transform: translateY(-3px) !important;
}

/* T√çTULOS */
/* ---- Header / t√≠tulo principal m√°s elegante ---- */
.page-title {
  display: block;
  margin: 8px 0 18px 0;
}
h1 {
  font-size: 3.2rem !important;
  line-height: 1.05 !important;
  color: var(--text-dark) !important;
  font-weight: 700 !important;
  margin-bottom: 8px !important;
}
.subtitle {
  display: block;
  color: var(--accent-secondary);
  font-size: 1.05rem;
  font-weight: 500;
  margin-bottom: 14px;
  padding-left: 8px;
  border-left: 4px solid rgba(6,182,212,0.12);
}

h2 {
  font-size: 2.2em !important;
  color: var(--accent-primary) !important;
  margin-top: 50px !important;
  border-left: 8px solid var(--accent-secondary) !important;
  padding-left: 20px !important;
  transition: all 0.3s ease !important;
  font-weight: 600 !important;
}

h2:hover {
  padding-left: 25px !important;
  color: var(--accent-secondary) !important;
}

h3 {
  font-size: 1.6em !important;
  color: var(--accent-secondary) !important;
  border-left: 5px solid var(--accent-positive) !important;
  padding-left: 15px !important;
  margin-top: 30px !important;
  font-weight: 500 !important;
}

/* P√ÅRRAFOS */
p {
  color: var(--text-dark) !important;
  font-size: 1.05em !important;
  line-height: 1.8 !important;
}

/* ========== TABLAS ========== */
table {
  box-shadow: 0 8px 30px rgba(0, 0, 0, 0.1) !important;
  border: 1px solid rgba(0, 0, 0, 0.05) !important;
  background: var(--bg-light) !important;
  border-radius: 10px !important;
  overflow: hidden !important;
  margin: 25px 0 !important;
}

thead {
  background: var(--accent-primary) !important;
}

th {
  color: var(--bg-light) !important;
  font-weight: 700 !important;
  padding: 15px 20px !important;
}

td {
  border-bottom: 1px solid var(--bg-lighter) !important;
  color: var(--text-dark) !important;
  padding: 12px 20px !important;
}

tbody tr:nth-child(even) {
  background-color: var(--bg-lighter) !important;
}

tbody tr:hover {
  background-color: rgba(6, 182, 212, 0.1) !important;
  transition: background-color 0.2s ease !important;
}

.section.level1 {
  background: linear-gradient(180deg, rgba(255,255,255,1) 0%, rgba(250,251,252,1) 100%);
  border-top: 6px solid var(--accent-primary);
  padding: 36px !important;
  transition: transform .28s cubic-bezier(.2,.9,.2,1), box-shadow .28s;
}
.section.level1:hover {
  transform: translateY(-6px);
  box-shadow: 0 28px 60px rgba(16,24,40,0.08);
}

/* ========== C√ìDIGO ========== */
pre {
  background: var(--bg-lighter) !important;
  border-left: 6px solid var(--accent-secondary) !important;
  box-shadow: 0 6px 25px rgba(0, 0, 0, 0.08) !important;
  border: 1px solid rgba(6, 182, 212, 0.2) !important;
  border-radius: 10px !important;
  padding: 25px !important;
}

/* ========== FOOTER ========== */
div[style*="margin-top: 80px;"] {
  background: var(--bg-lighter) !important;
  border: 1px solid rgba(0, 0, 0, 0.05) !important;
  border-top: 6px solid var(--accent-primary) !important;
  color: var(--text-dark) !important;
  border-radius: 12px;
  box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1) !important;
}
/* ======= DESPLAZAR EL CONTENIDO PARA QUE NO CHOQUE CON EL TOC ======= */
body .container-fluid,
body .main-container,
body div.container-fluid:first-of-type {
  margin-left: 280px !important;   /* un poco m√°s que el ancho del TOC */
  max-width: calc(100% - 300px) !important;
}


/* RESPONSIVE DESIGN */
@media (max-width: 768px) {
  #custom-toc {
    position: relative !important;
    width: 100% !important;
    height: auto !important;
    max-height: 300px !important;
    margin-bottom: 30px !important;
  }
  
  div.container-fluid:first-of-type {
    padding: 20px !important;
  }
}
/* ===================== BOT√ìN FLOTANTE UNIVERSIDAD ===================== */
#uv-button {
  position: fixed;
  bottom: 25px;
  right: 25px;   /* c√°mbialo a left:25px si lo quieres a la izquierda */
  width: 70px;
  height: 70px;
  border-radius: 50%;
  background: white;
  box-shadow: 0 6px 18px rgba(0,0,0,0.25);
  display: flex;
  justify-content: center;
  align-items: center;
  cursor: pointer;
  z-index: 9999;
  transition: transform 0.3s ease;
  overflow: hidden;
}

#uv-button:hover {
  transform: scale(1.1);
}

/* Imagen interna */
#uv-button img {
  width: 80%;
  height: 80%;
  object-fit: contain;
  transition: opacity .4s ease;
}

/* Animaci√≥n de rotaci√≥n */
@keyframes spin-logo {
  0% { transform: rotate(0deg); }
  100% { transform: rotate(360deg); }
}

#uv-button.spin {
  animation: spin-logo 1.2s linear;
}
#uv-button img {
  width: 80%;
  height: 80%;
  object-fit: contain;
  display: block;
  margin: auto;        
  position: absolute;  
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
}
/* ===== TOOLTIP PERSONALIZADO PARA EL BOT√ìN ===== */
/* ===== TOOLTIP HACIA LA IZQUIERDA ===== */
#uv-button::after {
  content: attr(data-tooltip);
  position: absolute;
  left: -10px;                /* empieza pegado al borde izquierdo */
  top: 50%;                   /* centrado verticalmente */
  transform: translate(-100%, -50%);  /* lo desplaza completamente a la izquierda */
  
  background: rgba(0,0,0,0.85);
  color: white;
  padding: 8px 12px;
  font-size: 0.85em;
  border-radius: 6px;
  white-space: nowrap;
  opacity: 0;
  pointer-events: none;
  transition: opacity 0.25s ease;
}

#uv-button:hover::after {
  opacity: 1;
}

#uv-button {
  position: fixed !important;
  z-index: 999999 !important;
  pointer-events: auto !important;
}
#custom-toc, #right-toc {
  z-index: 5000 !important;
}
#uv-button {
  overflow: visible !important;
}

/* ========== NUEVO: ESTILO PARA EL BOT√ìN INDIVIDUAL DE CADA CHUNK ========== */
.chunk-code-toggle {
  background-color: transparent;
  color: var(--accent-primary); /* Color verde/cian */
  border: 1px solid var(--accent-primary);
  padding: 4px 10px;
  border-radius: 6px;
  cursor: pointer;
  font-family: 'Inter', sans-serif;
  font-size: 0.85rem;
  font-weight: 600;
  margin-bottom: 5px; /* Espacio entre bot√≥n y c√≥digo */
  margin-top: 15px;   /* Espacio respecto al elemento anterior */
  transition: all 0.2s ease;
  display: inline-flex;
  align-items: center;
  gap: 5px;
}

.chunk-code-toggle:hover {
  background-color: var(--accent-primary);
  color: white;
  box-shadow: 0 4px 10px rgba(0, 184, 148, 0.2);
}

.chunk-code-toggle.active {
  background-color: var(--bg-lighter);
  color: var(--text-gray);
  border-color: var(--text-gray);
}

/* Ajuste para que el bloque de c√≥digo (pre) aparezca pegado al bot√≥n */
pre {
  margin-top: 0 !important;
  transition: all 0.3s ease;
}
</style>
```
<div id="uv-button" data-tooltip="Escuela de Ingenier√≠a Industrial - Cali">
  <img id="uv-img" src="univalle.png" alt="Univalle">
</div>

```{=html}
<script>
document.addEventListener('DOMContentLoaded', function() {
  const SCROLL_OFFSET = 100; // Ajusta este valor si el t√≠tulo queda tapado (100px es bueno)
  
  // 1. REFERENCIA AL CONTENEDOR DEL TOC
  const toc = document.getElementById("custom-toc");
  if (!toc) return; // Si no existe el div, no hace nada

  // 2. CREAR T√çTULO Y LISTA
  const title = document.createElement("h2");
  title.textContent = "Contenido";
  toc.appendChild(title);
  
  const list = document.createElement("ul");
  toc.appendChild(list);

  // 3. GENERAR ENLACES BASADOS EN H1 y H2
  const headers = document.querySelectorAll("h1, h2");
  
  headers.forEach(header => {
    // Si el header no tiene ID, creamos uno limpio
    if (!header.id) {
      header.id = header.textContent
        .toLowerCase()
        .replace(/[^a-z0-9]+/g, "-") // Reemplaza caracteres raros por guiones
        .replace(/^-+|-+$/g, '');    // Quita guiones al inicio o final
    }

    // Crear el elemento de lista
    const li = document.createElement("li");
    const a = document.createElement("a");
    
    a.href = `#${header.id}`; // Enlace interno al ID
    a.textContent = header.textContent; // Texto del enlace
    
    // === AQU√ç EST√Å LA MAGIA DEL CLIC ===
    a.addEventListener('click', function(e) {
      e.preventDefault(); // Evita el salto brusco predeterminado
      
      const targetId = this.getAttribute('href').substring(1); // Quita el #
      const targetElement = document.getElementById(targetId);
      
      if (targetElement) {
        // Scroll suave manual
        window.scrollTo({
          top: targetElement.offsetTop - SCROLL_OFFSET, 
          behavior: 'smooth'
        });
        
        // Actualizar URL sin saltar (opcional)
        history.pushState(null, null, `#${targetId}`);
      }
    });

    li.appendChild(a);
    list.appendChild(li);
  });

  // 4. RESALTAR ENLACE ACTIVO AL HACER SCROLL
  function updateActiveTOCLink() {
    const tocLinks = document.querySelectorAll('#custom-toc a');
    let currentActiveId = '';
    
    headers.forEach(section => {
      const rect = section.getBoundingClientRect();
      // Si la secci√≥n est√° cerca de la parte superior (con el offset)
      if (rect.top <= SCROLL_OFFSET + 20) { 
        currentActiveId = section.id;
      }
    });
    
    tocLinks.forEach(link => {
      link.classList.remove('active');
      if (link.getAttribute('href') === `#${currentActiveId}`) {
        link.classList.add('active');
      }
    });
  }

  // 5. EVENTOS GLOBALES
  window.addEventListener('scroll', updateActiveTOCLink);
  // Ejecutar una vez al inicio para marcar el primero
  updateActiveTOCLink(); 

  // --- EXTRAS (FECHA, BOT√ìN, ETC) ---
  
  // Fecha
  const fechaSpan = document.getElementById('fecha-entrega');
  if(fechaSpan) {
    fechaSpan.textContent = new Date().toLocaleDateString('es-ES', {
      year: 'numeric', month: 'long', day: 'numeric'
    });
  }

  // Bot√≥n C√≥digo
  const btnToggle = document.createElement('button');
  btnToggle.id = 'global-code-toggle';
  btnToggle.textContent = 'üíª C√≥digo Oculto';
  document.body.appendChild(btnToggle);
  let codeVisible = true;
  btnToggle.addEventListener('click', function() {
    const codes = document.querySelectorAll('pre');
    codeVisible = !codeVisible;
    codes.forEach(code => {
      code.style.display = codeVisible ? 'block' : 'none';
    });
    btnToggle.textContent = codeVisible ? 'üíª C√≥digo Oculto' : 'üëÅÔ∏è Mostrar C√≥digo';
  });

  // Animaci√≥n Logo Univalle
  const logos = ["univalle.png", "ingenieria.png"];  
  let index = 0;
  const img = document.getElementById("uv-img");
  const btn = document.getElementById("uv-button");
  if (btn && img) {
    setInterval(() => {
      btn.classList.add("spin");
      setTimeout(() => {
        index = (index + 1) % logos.length;
        img.style.opacity = 0;
        setTimeout(() => {
          img.src = logos[index];
          img.style.opacity = 1;
        }, 200);
      }, 600);
      setTimeout(() => btn.classList.remove("spin"), 1200);
    }, 3500);
  }
});
document.addEventListener('DOMContentLoaded', function() {
  const SCROLL_OFFSET = 100;

  // --- 1. L√ìGICA DEL TOC (Igual que antes) ---
  const toc = document.getElementById("custom-toc");
  if (toc) {
    const title = document.createElement("h2");
    title.textContent = "Contenido";
    toc.appendChild(title);
    const list = document.createElement("ul");
    toc.appendChild(list);

    const headers = document.querySelectorAll("h1, h2");
    headers.forEach(header => {
      if (!header.id) {
        header.id = header.textContent.toLowerCase()
          .replace(/[^a-z0-9]+/g, "-").replace(/^-+|-+$/g, '');
      }
      const li = document.createElement("li");
      const a = document.createElement("a");
      a.href = `#${header.id}`;
      a.textContent = header.textContent;
      
      a.addEventListener('click', function(e) {
        e.preventDefault();
        const targetId = this.getAttribute('href').substring(1);
        const targetElement = document.getElementById(targetId);
        if (targetElement) {
          window.scrollTo({
            top: targetElement.offsetTop - SCROLL_OFFSET, 
            behavior: 'smooth'
          });
          history.pushState(null, null, `#${targetId}`);
        }
      });
      li.appendChild(a);
      list.appendChild(li);
    });

    function updateActiveTOCLink() {
      const tocLinks = document.querySelectorAll('#custom-toc a');
      let currentActiveId = '';
      headers.forEach(section => {
        const rect = section.getBoundingClientRect();
        if (rect.top <= SCROLL_OFFSET + 20) { 
          currentActiveId = section.id;
        }
      });
      tocLinks.forEach(link => {
        link.classList.remove('active');
        if (link.getAttribute('href') === `#${currentActiveId}`) {
          link.classList.add('active');
        }
      });
    }
    window.addEventListener('scroll', updateActiveTOCLink);
    updateActiveTOCLink(); 
  }

  // --- 2. NUEVA L√ìGICA: BOTONES INDIVIDUALES PARA CADA C√ìDIGO ---
  
  // Seleccionamos todos los bloques de c√≥digo generados por R
  // R Markdown suele ponerlos en 'pre.r' o dentro de div.sourceCode
  const codeBlocks = document.querySelectorAll('pre.r, pre.sourceCode, .sourceCode pre');

  codeBlocks.forEach(block => {
    // 1. Ocultar el c√≥digo por defecto
    block.style.display = 'none';

    // 2. Crear el bot√≥n
    const btn = document.createElement('button');
    btn.className = 'chunk-code-toggle';
    btn.innerHTML = '<span>&#9654;</span> Ver C√≥digo'; // Icono de play
    
    // 3. Insertar el bot√≥n ANTES del bloque de c√≥digo
    // Buscamos el padre para insertar antes del <pre>
    block.parentNode.insertBefore(btn, block);

    // 4. Agregar evento click
    btn.addEventListener('click', function() {
      if (block.style.display === 'none') {
        // Mostrar
        block.style.display = 'block';
        btn.innerHTML = '<span>&#9660;</span> Ocultar C√≥digo';
        btn.classList.add('active');
      } else {
        // Ocultar
        block.style.display = 'none';
        btn.innerHTML = '<span>&#9654;</span> Ver C√≥digo';
        btn.classList.remove('active');
      }
    });
  });

  // --- 3. EXTRAS (FECHA, LOGOS) ---
  const fechaSpan = document.getElementById('fecha-entrega');
  if(fechaSpan) {
    fechaSpan.textContent = new Date().toLocaleDateString('es-ES', {
      year: 'numeric', month: 'long', day: 'numeric'
    });
  }

  // Elimin√© el bot√≥n global anterior para que no tengas conflicto, 
  // ya que ahora tienes botones individuales.

  // Animaci√≥n Logo Univalle
  const logos = ["univalle.png", "ingenieria.png"];  
  let index = 0;
  const img = document.getElementById("uv-img");
  const btn = document.getElementById("uv-button");
  if (btn && img) {
    setInterval(() => {
      btn.classList.add("spin");
      setTimeout(() => {
        index = (index + 1) % logos.length;
        img.style.opacity = 0;
        setTimeout(() => {
          img.src = logos[index];
          img.style.opacity = 1;
        }, 200);
      }, 600);
      setTimeout(() => btn.classList.remove("spin"), 1200);
    }, 3500);
  }
});
</script>

```
```{r setup-theme, include=FALSE}
library(ggplot2)
library(forecast)
library(tseries)

tesla_pal <- list(
  bg        = "#ffffff",    # Tu --bg-li
  text_main = "#1f2937",    # Tu --text-dark
  text_gray = "#4b5563",    # Tu --text-medium
  primary   = "#00b894",    # Tu --accent-primary (Verde/Cian principal)
  secondary = "#06b6d4",    # Tu --accent-secondary (Cian claro)
  positive  = "#84cc16",    # Tu --accent-positive
  negative  = "#e17055",    # Tu --accent-negative
  grid      = "#f3f4f6"     # Un gris muy sutil para las rejillas
)

theme_tesla <- function() {
  theme_minimal(base_size = 14) +
    theme(
      plot.background = element_rect(fill = "transparent", color = NA),
      panel.background = element_rect(fill = "transparent", color = NA),
      text = element_text(color = tesla_pal$text_main, family = "sans"),
      plot.title = element_text(face = "bold", size = 16, color = tesla_pal$text_main, margin = margin(b = 10)),
      plot.subtitle = element_text(size = 12, color = tesla_pal$secondary, margin = margin(b = 10)),
      plot.caption = element_text(size = 9, color = tesla_pal$text_gray, margin = margin(t = 10)),
      axis.title = element_text(face = "bold", size = 11, color = tesla_pal$text_gray),
      axis.text = element_text(size = 10, color = tesla_pal$text_gray),
      axis.line.x = element_line(color = tesla_pal$secondary, size = 0.5), 
      panel.grid.major = element_line(color = tesla_pal$grid, linetype = "dashed"),
      panel.grid.minor = element_blank(),
      legend.position = "bottom",
      legend.background = element_rect(fill = "transparent", color = NA),
      legend.key = element_rect(fill = "transparent", color = NA)
    )
}

theme_set(theme_tesla())

update_geom_defaults("line", list(color = tesla_pal$primary, size = 1.1))
update_geom_defaults("point", list(color = tesla_pal$secondary, size = 2))
update_geom_defaults("col", list(fill = tesla_pal$primary, color = NA))

```
---

# An√°lisis de Series de Tiempo y Pron√≥sticos ARIMA

Estudio Emp√≠rico sobre el Precio de Acciones de Tesla Inc.

---

# 1. Introducci√≥n

## 1.1 Relevancia del An√°lisis



## 1.2 Metodolog√≠a: Modelos ARIMA


---

# 2. Descripci√≥n de la Serie Temporal

## 2.1 serie QQQ historica 

```{r serie, echo=TRUE, warning=FALSE, message=FALSE}
library(tidyquant)
library(tidyverse)
library(ggplot2)
library(zoo)
library(plotly)

serie <- getSymbols('QQQ', src='yahoo', auto.assign=FALSE, from="2010-01-01")
precios <- serie$QQQ.Close
datos_qqq <- data.frame(
  Fecha = index(precios),
  Precio = as.numeric(precios)
)
datos_qqq <- datos_qqq %>%
  mutate(Corte = as.yearqtr(Fecha)) 
lista_frames <- lapply(unique(datos_qqq$Corte), function(c) {
  dt <- datos_qqq[datos_qqq$Corte <= c, ]
  dt$Frame <- as.character(c) 
  return(dt)
})

datos_animados <- dplyr::bind_rows(lista_frames)
p <- ggplot(datos_animados, aes(x = Fecha, y = Precio)) +
  
  geom_area(aes(frame = Frame), fill = tesla_pal$primary, alpha = 0.1, position = "identity") +
  
  geom_line(aes(frame = Frame), color = tesla_pal$primary, size = 0.8) +
  
  labs(
    title = "Evoluci√≥n Din√°mica del QQQ",
    subtitle = "Crecimiento hist√≥rico acumulado",
    x = "", 
    y = "Precio (USD)"
  ) +
  scale_y_continuous(labels = scales::dollar_format()) +
  theme_tesla() +
  theme(plot.title = element_text(size = 14))

plotly::ggplotly(p, tooltip = c("x", "y")) %>%
  plotly::layout(
    paper_bgcolor = 'rgba(0,0,0,0)',
    plot_bgcolor = 'rgba(0,0,0,0)',
    font = list(family = "Inter, sans-serif", color = tesla_pal$text_gray),
    hovermode = "x unified"
  ) %>%
  plotly::animation_opts(
    frame = 100,       
    transition = 0,    
    redraw = FALSE     
  ) %>%
  plotly::animation_slider(
    currentvalue = list(prefix = "Periodo: ") 
  ) %>%
  plotly::config(displayModeBar = FALSE)
```

## 2.2 Divisi√≥n sectorial 


```{r tortA, echo=TRUE, warning=FALSE, message=FALSE}
library(plotly)
sectores <- data.frame(
  Sector = c("Tecnolog√≠a", "Consumo Discrecional", "Servicios de Comunicaci√≥n", 
             "Consumo B√°sico", "Industriales", "Salud", "Otros", 
             "Servicios P√∫blicos", "Materiales", "Energ√≠a"),
  Peso = c(53.60, 13.04, 12.61, 4.99, 4.58, 4.28, 3.22, 1.38, 1.25, 0.47)
)

colores_sector <- c(
  "#2b5c8a",
  "#5d5b94", 
  "#8e6fa3",
  "#c46d9e",
  "#e67586", 
  "#f38972", 
  "#f8a262",
  "#fbc058", 
  "#fce05d", 
  "#34495e"  
)
fig_pie <- plot_ly(sectores, labels = ~Sector, values = ~Peso, type = 'pie',
        textposition = 'outside',      
        textinfo = 'label+percent',    
        hoverinfo = 'label+value+percent',
        marker = list(
          colors = colores_sector, 
          line = list(color = '#ffffff', width = 1.5) 
        ),
        sort = FALSE, 
        automargin = TRUE
)

fig_pie <- fig_pie %>% layout(
  title = list(
    text = "<b>Asignaci√≥n Sectorial</b>",
    font = list(size = 22, family = "Poppins, sans-serif", color = tesla_pal$text_main),
    x = 0.05, 
    y = 0.95
  ),
  showlegend = FALSE, 
  margin = list(t = 80, b = 40, l = 80, r = 80), 
  paper_bgcolor = 'rgba(0,0,0,0)',
  plot_bgcolor = 'rgba(0,0,0,0)',
  font = list(family = "Inter, sans-serif", size = 12, color = tesla_pal$text_gray)
)

fig_pie

```

## 2.3 Mayores Holdings 

```{r top10, echo=TRUE, warning=FALSE, message=FALSE}

library(packcircles)
library(dplyr)
library(ggplot2)
library(plotly)

top10 <- data.frame(
  ticker = c("NVDA","AAPL","MSFT","AVGO","AMZN","GOOGL","GOOG","TSLA","META","NFLX"),
  empresa = c("NVIDIA","Apple Inc.","Microsoft","Broadcom Inc.","Amazon.com, Inc.",
              "Alphabet Class A","Alphabet Class C","Tesla, Inc.","Meta Plataformas, Inc.","Netflix, Inc."),
  peso = c(9.33, 8.78, 7.69, 6.59, 5.21, 3.97, 3.71, 3.31, 2.93, 2.36),
  sector = c("Tecnolog√≠a","Tecnolog√≠a","Tecnolog√≠a","Tecnolog√≠a",
             "Consumo","Comunicaci√≥n","Comunicaci√≥n",
             "Consumo","Comunicaci√≥n","Consumo"),
  stringsAsFactors = FALSE
)

otros_val <- round(100 - sum(top10$peso), 2)
holdings <- bind_rows(top10,
                      data.frame(ticker="OTROS", empresa="Resto del QQQ",
                                 peso = otros_val, sector="Varios", stringsAsFactors = FALSE)) %>%
  arrange(desc(peso))

packing <- circleProgressiveLayout(holdings$peso, sizetype='area')
holdings_pack <- cbind(holdings, packing)
holdings_pack$id <- seq_len(nrow(holdings_pack))
holdings_pack <- holdings_pack %>% rename(center_x = x, center_y = y)

dat.gg <- circleLayoutVertices(packing, npoints = 100)
dat.gg <- merge(dat.gg, holdings_pack, by = "id")

holdings_pack <- holdings_pack %>%
  mutate(
    peso_label = gsub("\\.", ",", formatC(peso, digits = 2, format = "f")),
    hover_text = paste0(
      empresa, "\n",
      "Ticker: ", ticker, "\n",
      "Peso: ", peso_label, "%\n",
      "Sector: ", sector
    ),
    label_text = ifelse(peso >= 2.3, paste0(ticker, "\n", peso_label, "%"), "")
  )

fill_map <- c(
  "Tecnolog√≠a"   = tesla_pal$primary,
  "Consumo"      = tesla_pal$secondary,
  "Comunicaci√≥n" = "#3b82f6",
  "Varios"       = tesla_pal$text_gray
)

p_bubble <- ggplot() +
  geom_polygon(
    data = dat.gg,
    aes(x = x, y = y, group = id, fill = sector,
        text = holdings_pack$hover_text[match(id, holdings_pack$id)]),
    color = "white", size = 0.5, alpha = 0.95
  ) +
  geom_text(
    data = holdings_pack,
    aes(x = center_x, y = center_y, label = label_text, text = hover_text),
    size = 3.8, color = "white", fontface = "bold", lineheight = 0.9
  ) +
  scale_fill_manual(values = fill_map) +
  theme_void() +
  coord_equal() +
  labs(title = "Composici√≥n del Portafolio QQQ",
       subtitle = "Top holdings seg√∫n la imagen") +
  theme(
    plot.title = element_text(face = "bold", size = 16, color = tesla_pal$text_main, hjust = 0.5),
    plot.subtitle = element_text(size = 12, color = tesla_pal$text_gray, hjust = 0.5),
    legend.position = "bottom",
    legend.title = element_blank(),
    plot.margin = margin(10,10,10,10)
  )

ggplotly(p_bubble, tooltip = "text") %>%
  config(displayModeBar = FALSE) %>%
  layout(
    font = list(family = "Inter", color = tesla_pal$text_main),
    plot_bgcolor  = "rgba(0,0,0,0)",
    paper_bgcolor = "rgba(0,0,0,0)",
    legend = list(orientation = "h", yanchor = "bottom", y = -0.12, xanchor = "center", x = 0.5),
    hoverlabel = list(
      bgcolor = "rgba(255,255,255,0.97)",
      bordercolor = "rgba(0,0,0,0.08)",
      font = list(family = "Inter", color = tesla_pal$text_main, size = 11)
    )
  )
```

## 2.4 An√°lisis Estad√≠stico


```{r tabla, echo=TRUE, warning=FALSE, message=FALSE}
library(moments)
library(knitr)

serie_vec <- as.numeric(serie)
valores_calculados <- c(
    length(serie_vec),
    mean(serie_vec, na.rm = TRUE),
    median(serie_vec, na.rm = TRUE),
    min(serie_vec, na.rm = TRUE),
    max(serie_vec, na.rm = TRUE),
    max(serie_vec, na.rm = TRUE) - min(serie_vec, na.rm = TRUE),
    var(serie_vec, na.rm = TRUE),
    sd(serie_vec, na.rm = TRUE),
    skewness(serie_vec, na.rm = TRUE),
    kurtosis(serie_vec, na.rm = TRUE)
)

desc <- data.frame(
  M√©trica = c(
    "Observaciones Totales",
    "Media",
    "Mediana",
    "M√≠nimo",
    "M√°ximo",
    "Rango",
    "Varianza",
    "Desviaci√≥n Est√°ndar",
    "Asimetr√≠a (Skewness)",
    "Curtosis"
  ),
  Valor = format(valores_calculados, scientific = FALSE, big.mark = ",", digits = 2, nsmall = 2)
)

kable(
  desc,
  format = "html",
  align = c('l', 'r'),
  table.attr = "class='table' style='width:60%; margin:auto; font-size:18px;'"
)

```

## 2.5 Rendimientos Diarios

```{r tablarendimientos, echo=TRUE, warning=FALSE, message=FALSE}
library(quantmod)
library(dplyr)
library(ggplot2)
library(tidyverse)
library(knitr)
precios <- serie$QQQ.Close
ret_diario  <- dailyReturn(precios, type = "log")
ret_mensual <- monthlyReturn(precios, type = "log")
ret_anual   <- yearlyReturn(precios, type = "log")
vol_anual <- sd(ret_diario) * sqrt(252)
resumen <- data.frame(
  Concepto = "Volatilidad Anualizada (Riesgo)",
  Valor = scales::percent(vol_anual, accuracy = 0.01)
)
kable(resumen, 
      format = "html", 
      table.attr = "class='table' style='width:50%; margin:auto;'")

```


## 2.6 Retornos Diarios

```{r tablaretrnosentos, echo=TRUE, warning=FALSE, message=FALSE}
ret_df <- data.frame(Retorno = as.numeric(ret_diario))

ggplot(ret_df, aes(x = Retorno)) +
  geom_histogram(aes(y = ..density..), bins = 60, fill = tesla_pal$primary, alpha = 0.4) +
  geom_density(color = tesla_pal$secondary, size = 1.2) +
  labs(title = "Distribuci√≥n de los Rendimientos Diarios del QQQ",
       x = "Retorno Diario (log)", y = "Densidad") +
  theme_tesla()

```




```{r boxpllot, echo=TRUE, warning=FALSE, message=FALSE}

ret_anual_df <- data.frame(
  Fecha = index(ret_diario),
  Ret = as.numeric(ret_diario),
  A√±o = format(index(ret_diario), "%Y")
)

ggplot(ret_anual_df, aes(x = A√±o, y = Ret, group = A√±o)) +
  geom_boxplot(fill = tesla_pal$primary, alpha = 0.7) +
  labs(title = "Distribuci√≥n de los Retornos Diarios por A√±o (QQQ)",
       x = "A√±o", y = "Retorno Diario") +
  theme_tesla() +
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5))

```


## 2.7 Rendimientos por a√±o

```{r rendimientosa√±o, echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
library(dplyr)
library(ggplot2)
library(lubridate)
ret_anual_df <- data.frame(
  A√±o = year(index(ret_anual)),
  Retorno = round(100 * as.numeric(ret_anual), 2)
)

ggplot(ret_anual_df, aes(x = factor(A√±o), y = Retorno)) +
  geom_col(fill = tesla_pal$primary) +
  geom_text(
    aes(label = paste0(Retorno, "%")),
    vjust = -0.5,
    color = tesla_pal$text_main,  
    size = 4
  ) +
  labs(title = "Retorno Anual del QQQ",
       x = "A√±o", y = "Retorno (%)") +
  theme_tesla()
```

## 2.8 Drawdown 


```{r drawdown, echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
library(PerformanceAnalytics)
library(ggplot2)
library(dplyr)
ret_diario <- dailyReturn(precios, type = "log")

dd <- PerformanceAnalytics::Drawdowns(ret_diario)
dd_df <- data.frame(
  Fecha = index(dd),
  Drawdown = as.numeric(dd)
)
ggplot(dd_df, aes(x = Fecha, y = Drawdown)) +
  geom_line(color = tesla_pal$primary, linewidth = 0.7) +
  labs(title = "Drawdown Hist√≥rico del QQQ",
       x = "", y = "Drawdown") +
  scale_y_continuous(labels = scales::percent_format(accuracy = 1)) +
  theme_tesla()
```

## 2.9 M√©tricas Financieras 

```{r metrics_financieras, echo=TRUE, warning=FALSE, message=FALSE}
library(PerformanceAnalytics)
library(xts)

# C√°lculo de m√©tricas
cagr <- Return.annualized(ret_diario, scale = 252)
cumulative_return <- Return.cumulative(ret_diario)

sharpe_annual <- (mean(ret_diario, na.rm=TRUE) / sd(ret_diario, na.rm=TRUE)) * sqrt(252)
sortino <- SortinoRatio(ret_diario, MAR = 0)
max_dd <- maxDrawdown(ret_diario)

calmar <- as.numeric(cagr) / abs(as.numeric(max_dd))

# Tabla con m√©tricas
metrics <- data.frame(
  M√©trica = c("CAGR (anual)", "Retorno acumulado", "Sharpe (aprx anual)", 
              "Sortino", "Max Drawdown", "Calmar"),
  Valor = c(
    scales::percent(as.numeric(cagr), accuracy = 0.01),
    scales::percent(as.numeric(cumulative_return), accuracy = 0.01),
    round(as.numeric(sharpe_annual), 3),
    round(as.numeric(sortino), 3),
    scales::percent(as.numeric(max_dd), accuracy = 0.1),
    round(as.numeric(calmar), 3)
  ),
  stringsAsFactors = FALSE
)

knitr::kable(metrics, format = "html", table.attr = "class='table' style='width:60%; margin:auto;'")
```

```{r rolling_vol, echo=TRUE, warning=FALSE, message=FALSE}
library(zoo)

rollsd30  <- rollapply(as.numeric(ret_diario), width = 30, FUN = sd, fill = NA, align = "right")
rollsd90  <- rollapply(as.numeric(ret_diario), width = 90, FUN = sd, fill = NA, align = "right")
rollsd252 <- rollapply(as.numeric(ret_diario), width = 252, FUN = sd, fill = NA, align = "right")

df_roll <- data.frame(
  Fecha = index(ret_diario),
  vol30 = rollsd30 * sqrt(252),
  vol90 = rollsd90 * sqrt(252),
  vol252 = rollsd252 * sqrt(252)
)

library(reshape2)
dfm <- melt(df_roll, id.vars = "Fecha", variable.name = "Window", value.name = "VolAnual")

ggplot(dfm, aes(x = Fecha, y = VolAnual, color = Window)) +
  geom_line(size = 0.8) +
  scale_y_continuous(labels = scales::percent_format(accuracy = 0.1)) +
  labs(title = "Volatilidad Rolling (annualizada)", y = "Vol Annualizada", x = "") +
  scale_color_manual(values = c("vol30" = tesla_pal$primary, "vol90" = tesla_pal$secondary, "vol252" = tesla_pal$text_gray)) +
  theme_tesla()
```

## 3 Estacionalidad Mensual del QQQ (2010‚Äì2025)

```{r heatmap_estacional_mejor, echo=TRUE, warning=FALSE, message=FALSE}
library(ggplot2)
library(viridis)

df_m <- data.frame(Fecha = index(ret_mensual), Ret = as.numeric(ret_mensual))
df_m <- df_m %>% mutate(A√±o = lubridate::year(Fecha), Mes = lubridate::month(Fecha, label = TRUE, abbr = TRUE), RetP = Ret*100)
tabla_m <- df_m %>% group_by(A√±o, Mes) %>% summarise(RetP = mean(RetP, na.rm = TRUE))
ggplot(tabla_m, aes(x = Mes, y = factor(A√±o), fill = RetP)) +
  geom_tile(color = "white") +
  scale_fill_viridis_c(option = "C", direction = 1, name = "Ret (%)") +
  labs(title = "Heatmap Estacional Mensual (QQQ)") +
  theme_tesla()
```

## 3.1 Resumen anual

```{r resumen_anual_tabla, echo=TRUE, warning=FALSE, message=FALSE}
library(dplyr)
library(tidyr)

df_ann <- data.frame(Fecha = index(ret_anual), Ret = as.numeric(ret_anual))
df_ann <- df_ann %>% mutate(A√±o = lubridate::year(Fecha), RetPct = Ret * 100)
vol_year <- ret_diario %>% 
  data.frame(Fecha = index(ret_diario), Ret = as.numeric(ret_diario)) %>%
  mutate(A√±o = lubridate::year(Fecha)) %>%
  group_by(A√±o) %>%
  summarise(Vol = sd(Ret, na.rm=TRUE)*sqrt(252)*100, Ret = sum(Ret)*100)
dd_df <- data.frame(Fecha = index(ret_diario), Ret = as.numeric(ret_diario))
dd_df <- dd_df %>% mutate(A√±o = lubridate::year(Fecha))
maxdd_yr <- dd_df %>% group_by(A√±o) %>%
  summarise(MaxDD = min( cumprod(1+Ret) / cummax(cumprod(1+Ret)) - 1 ) * 100)

res_yr <- left_join(vol_year, maxdd_yr, by = "A√±o") %>% arrange(desc(A√±o))
knitr::kable(res_yr, format = "html")
```




# 3. Resultados del Modelo ARIMA

## 3.1 Evaluaci√≥n de Estacionariedad

[**PLACEHOLDER:** Documenta pruebas de estacionariedad KPSS y ADF. Interpreta resultados]

```{r estacionariedad, echo=TRUE, eval=FALSE}
library(urca)
library(tseries)

summary(ur.kpss(datos_tesla$Close))
adf.test(datos_tesla$Close)
```

## 3.2 An√°lisis ACF y PACF

[**PLACEHOLDER:** Inserta gr√°ficos ACF y PACF. Analiza patrones de autocorrelaci√≥n]

```{r acf, echo=TRUE, eval=FALSE}
library(ggplot2)
ggtsdisplay(diff(datos_tesla$Close))
```

## 3.3 Selecci√≥n del Modelo

[**PLACEHOLDER:** Documenta par√°metros p, d, q seleccionados y justificaci√≥n]

| Par√°metro | Valor | Justificaci√≥n |
|:---|:--:|:---|
| p | [ ] | [Basado en PACF] |
| d | [ ] | [Basado en tests de estacionariedad] |
| q | [ ] | [Basado en ACF] |

## 3.4 Ajuste del Modelo

[**PLACEHOLDER:** Resumen del modelo ARIMA ajustado con coeficientes interpretados]

```{r arima, echo=TRUE, eval=FALSE}
library(forecast)
fit <- auto.arima(datos_tesla$Close, seasonal=FALSE)
summary(fit)
```

## 3.5 Diagn√≥stico de Residuos

[**PLACEHOLDER:** An√°lisis de residuos: gr√°ficos, pruebas de normalidad y autocorrelaci√≥n]

```{r residuos, echo=TRUE, eval=FALSE}
checkresiduals(fit)
```

## 3.6 Pron√≥sticos

[**PLACEHOLDER:** Pron√≥sticos para per√≠odos futuros con intervalos de confianza]

```{r forecast, echo=TRUE, eval=FALSE}
forecast_tesla <- forecast(fit, h=10)
autoplot(forecast_tesla)
```

---

# 4. Conclusiones

## 4.1 Hallazgos Principales

[**PLACEHOLDER:** Resumen de hallazgos principales del an√°lisis ARIMA]

## 4.2 Implicaciones Pr√°cticas

[**PLACEHOLDER:** Implicaciones de los pron√≥sticos para inversionistas y analistas de mercado]

## 4.3 Limitaciones del An√°lisis

[**PLACEHOLDER:** Limitaciones del modelo y aspectos no capturados]

## 4.4 Recomendaciones Futuras

[**PLACEHOLDER:** Sugerencias para mejoras y extensiones del an√°lisis]



```{=html}

<div style="
  margin-top: 80px;
  padding: 40px;
  background: linear-gradient(135deg, rgba(124, 58, 237, 0.15), rgba(6, 182, 212, 0.08));
  border: 2px solid rgba(124, 58, 237, 0.4);
  border-radius: 15px;
  border-top: 3px solid rgba(132, 204, 22, 0.8);
  text-align: center;
  color: #e0e6ed;
  font-size: 0.95em;
  line-height: 1.8;
  box-shadow: 0 8px 30px rgba(124, 58, 237, 0.2);
">
  <div style="margin-bottom: 20px; background: linear-gradient(135deg, #7c3aed, #06b6d4); -webkit-background-clip: text; -webkit-text-fill-color: transparent; font-weight: 700; font-size: 1.1em;">
    ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
  </div>
  
  <strong style="background: linear-gradient(135deg, #7c3aed, #06b6d4); -webkit-background-clip: text; -webkit-text-fill-color: transparent;">ASIGNATURA:</strong> Gesti√≥n de Datos<br>
  <strong style="background: linear-gradient(135deg, #7c3aed, #06b6d4); -webkit-background-clip: text; -webkit-text-fill-color: transparent;">PROFESOR:</strong> Orlando Joaqui-Barandica<br>
  <strong style="background: linear-gradient(135deg, #7c3aed, #06b6d4); -webkit-background-clip: text; -webkit-text-fill-color: transparent;">UNIVERSIDAD:</strong> Universidad del Valle<br>
  <strong style="background: linear-gradient(135deg, #7c3aed, #06b6d4); -webkit-background-clip: text; -webkit-text-fill-color: transparent;">FACULTAD:</strong> Facultad de Ingenier√≠a<br>
  <strong style="background: linear-gradient(135deg, #7c3aed, #06b6d4); -webkit-background-clip: text; -webkit-text-fill-color: transparent;">PROGRAMA:</strong> Ingenier√≠a Industrial<br>
  
  <div style="margin-top: 20px; padding-top: 20px; border-top: 1px solid rgba(124, 58, 237, 0.3);">
    <strong style="background: linear-gradient(135deg, #06b6d4, #84cc16); -webkit-background-clip: text; -webkit-text-fill-color: transparent;">ESTUDIANTE:</strong> Camilo<br>
    <strong style="background: linear-gradient(135deg, #06b6d4, #84cc16); -webkit-background-clip: text; -webkit-text-fill-color: transparent;">FECHA ENTREGA:</strong> <span id="fecha-entrega"></span><br>
    <strong style="background: linear-gradient(135deg, #06b6d4, #84cc16); -webkit-background-clip: text; -webkit-text-fill-color: transparent;">VERSI√ìN:</strong> 1.0<br>
  </div>
  
  <div style="margin-top: 20px; color: #94a3b8; font-size: 0.9em;">
    <em>Documento generado con R Markdown | Tema: Series de Tiempo y Pron√≥sticos ARIMA</em>
  </div>
  
  <div style="margin-top: 15px; background: linear-gradient(135deg, #7c3aed, #06b6d4); -webkit-background-clip: text; -webkit-text-fill-color: transparent; font-weight: 700;">
    ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
  </div>
</div>
```



