---
title: "An√°lisis de Series de Tiempo y Pron√≥st√≥sticos ARIMA"
subtitle: "Estudio Emp√≠rico sobre el Precio de Acciones de Tesla Inc."
author: "Camilo"
date: "`r format(Sys.Date(), '%d de %B de %Y')`"
output:
  html_document:
    theme: darkly
    toc: false         
    toc_float: false   
---



<div id="custom-toc"></div>


```{=html}
<style type="text/css">

/* ========== PALETA DE COLORES CLARA - EST√âTICA PROFESIONAL Y DIN√ÅMICA ========== */
@import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&family=Poppins:wght@500;600;700&display=swap');

html, body {
  font-family: 'Inter', system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif !important;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}
h1, h2, h3 {
  font-family: 'Poppins', 'Inter', sans-serif !important;
  letter-spacing: -0.02em;
}
:root {
  /* Colores Base */
  --bg-light: #ffffff;
  --bg-lighter: #f5f7fa;
  --text-dark: #1f2937;
  --text-medium: #4b5563;
  --text-gray: #94a3b8;

  /* Acentos QQQ: Cian/Verde */
  --accent-primary: #00b894;
  --accent-secondary: #06b6d4;
  --accent-positive: #84cc16;
  --accent-negative: #e17055;
  --accent-soft: #3b82f6;
}

/* ========== RESET & ESTRUCTURA CLAVE ========== */
* {
  box-sizing: border-box !important;
  margin: 0;
  padding: 0;
}

html, body {
  background: var(--bg-light) !important;
  color: var(--text-dark) !important;
  font-family: 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif !important;
  line-height: 1.65 !important;
  overflow-x: hidden !important;
  min-height: 100vh !important;
}

/* Contenedor de contenido central */
div.container-fluid:first-of-type {
  width: auto !important;
  max-width: 100% !important;
  padding: 60px 80px !important;
}

/* ========== TOC PERSONALIZADO "CONTENIDO" ========== */
/* ========== TOC PERSONALIZADO "CONTENIDO" ========== */
#custom-toc {
  position: fixed;
  top: 60px;
  left: 0;
  width: 260px;
  height: 80vh;
  /* CAMBIOS IMPORTANTES AQU√ç: */
  display: flex;              /* Usar flexbox para organizar hijos */
  flex-direction: column;     /* Uno debajo del otro */
  overflow: hidden;           /* El contenedor NO scrollea, solo sus hijos */
  /* Fin de cambios */
  padding: 0;                 /* Quitamos padding general para manejarlo dentro */
  background: var(--bg-lighter);
  border-right: 2px solid var(--accent-secondary);
  border-radius: 0 10px 10px 0;
  box-shadow: 0 4px 20px rgba(0,0,0,0.15);
  z-index: 999;
}

/* T√≠tulo del TOC */
#custom-toc h2 {
  position: relative;
  flex-shrink: 0;
  background: var(--bg-lighter);
  z-index: 10;
  /* CAMBIO AQU√ç: Reduje el padding superior de 20px a 10px */
  padding: 10px 15px 15px 15px; 
  margin: 0;
  border-bottom: 2px solid rgba(0, 184, 148, 0.3);
  box-shadow: 0 4px 6px -1px rgba(0,0,0,0.05); /* Sombra sutil para separar */
}

/* dar espacio despu√©s del t√≠tulo */
/* Lista de enlaces (Aqu√≠ ocurre el scroll) */
#custom-toc ul {
  list-style: none !important;
  /* CAMBIO AQU√ç: El primer valor (arriba) ahora es 0px */
  padding: 0px 10px 20px 10px !important; 
  margin: 0 !important;
  flex-grow: 1;               
  overflow-y: auto;           
  
  scrollbar-width: thin;
  scrollbar-color: var(--accent-secondary) transparent;
}

/* CAMBIO EXTRA: Asegura que el primer √≠tem suba al m√°ximo */
#custom-toc li:first-child {
  margin-top: 2px !important; /* Muy pegado arriba */
}

#custom-toc li {
  margin: 8px 0 !important;
}

/* Estilo de enlaces del TOC */
#custom-toc a {
  display: block;
  padding: 10px 14px;
  color: var(--text-medium) !important;
  text-decoration: none;
  border-radius: 8px;
  transition: all .2s ease;
}

#custom-toc a:hover {
  background: rgba(0,184,148,0.15);
  color: var(--accent-primary) !important;
  transform: translateX(5px);
  box-shadow: 0 4px 14px rgba(0,0,0,0.12);
}

/* Enlace activo */
#custom-toc a.active {
  background: var(--bg-light);
  color: var(--accent-primary) !important;
  border-left: 5px solid var(--accent-secondary);
  font-weight: 600;
  transform: translateX(4px);
}

/* Scrollbar est√©tico */
#custom-toc::-webkit-scrollbar {
  width: 6px !important;
}

#custom-toc::-webkit-scrollbar-thumb {
  background: var(--accent-secondary) !important;
  border-radius: 10px !important;
}

/* Ocultar el TOC nativo de R Markdown */
#TOC {
  display: none !important;
}


/* ========== SECCIONES Y TIPOGRAF√çA ========== */
.section.level1 {
  margin-bottom: 80px !important;
  padding: 50px !important;
  background: var(--bg-light) !important;
  border: 1px solid rgba(0, 0, 0, 0.05) !important;
  border-top: 6px solid var(--accent-primary) !important;
  border-radius: 12px !important;
  box-shadow: 0 12px 40px rgba(0, 0, 0, 0.1) !important;
  transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1) !important;
}

.section.level1:hover {
  border-top-color: var(--accent-secondary) !important;
  box-shadow: 0 18px 55px rgba(0, 0, 0, 0.15) !important;
  transform: translateY(-3px) !important;
}

/* T√çTULOS */
/* ---- Header / t√≠tulo principal m√°s elegante ---- */
.page-title {
  display: block;
  margin: 8px 0 18px 0;
}
h1 {
  font-size: 3.2rem !important;
  line-height: 1.05 !important;
  color: var(--text-dark) !important;
  font-weight: 700 !important;
  margin-bottom: 8px !important;
}
.subtitle {
  display: block;
  color: var(--accent-secondary);
  font-size: 1.05rem;
  font-weight: 500;
  margin-bottom: 14px;
  padding-left: 8px;
  border-left: 4px solid rgba(6,182,212,0.12);
}

h2 {
  font-size: 2.2em !important;
  color: var(--accent-primary) !important;
  margin-top: 50px !important;
  border-left: 8px solid var(--accent-secondary) !important;
  padding-left: 20px !important;
  transition: all 0.3s ease !important;
  font-weight: 600 !important;
}

h2:hover {
  padding-left: 25px !important;
  color: var(--accent-secondary) !important;
}

h3 {
  font-size: 1.6em !important;
  color: var(--accent-secondary) !important;
  border-left: 5px solid var(--accent-positive) !important;
  padding-left: 15px !important;
  margin-top: 30px !important;
  font-weight: 500 !important;
}

/* P√ÅRRAFOS */
p {
  color: var(--text-dark) !important;
  font-size: 1.05em !important;
  line-height: 1.8 !important;
}

/* ========== TABLAS ========== */
table {
  box-shadow: 0 8px 30px rgba(0, 0, 0, 0.1) !important;
  border: 1px solid rgba(0, 0, 0, 0.05) !important;
  background: var(--bg-light) !important;
  border-radius: 10px !important;
  overflow: hidden !important;
  margin: 25px 0 !important;
}

thead {
  background: var(--accent-primary) !important;
}

th {
  color: var(--bg-light) !important;
  font-weight: 700 !important;
  padding: 15px 20px !important;
}

td {
  border-bottom: 1px solid var(--bg-lighter) !important;
  color: var(--text-dark) !important;
  padding: 12px 20px !important;
}

tbody tr:nth-child(even) {
  background-color: var(--bg-lighter) !important;
}

tbody tr:hover {
  background-color: rgba(6, 182, 212, 0.1) !important;
  transition: background-color 0.2s ease !important;
}

.section.level1 {
  background: linear-gradient(180deg, rgba(255,255,255,1) 0%, rgba(250,251,252,1) 100%);
  border-top: 6px solid var(--accent-primary);
  padding: 36px !important;
  transition: transform .28s cubic-bezier(.2,.9,.2,1), box-shadow .28s;
}
.section.level1:hover {
  transform: translateY(-6px);
  box-shadow: 0 28px 60px rgba(16,24,40,0.08);
}

/* ========== C√ìDIGO ========== */
pre {
  background: var(--bg-lighter) !important;
  border-left: 6px solid var(--accent-secondary) !important;
  box-shadow: 0 6px 25px rgba(0, 0, 0, 0.08) !important;
  border: 1px solid rgba(6, 182, 212, 0.2) !important;
  border-radius: 10px !important;
  padding: 25px !important;
}

/* ========== FOOTER ========== */
div[style*="margin-top: 80px;"] {
  background: var(--bg-lighter) !important;
  border: 1px solid rgba(0, 0, 0, 0.05) !important;
  border-top: 6px solid var(--accent-primary) !important;
  color: var(--text-dark) !important;
  border-radius: 12px;
  box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1) !important;
}
/* ======= DESPLAZAR EL CONTENIDO PARA QUE NO CHOQUE CON EL TOC ======= */
body .container-fluid,
body .main-container,
body div.container-fluid:first-of-type {
  margin-left: 280px !important;   /* un poco m√°s que el ancho del TOC */
  max-width: calc(100% - 300px) !important;
}


/* RESPONSIVE DESIGN */
@media (max-width: 768px) {
  #custom-toc {
    position: relative !important;
    width: 100% !important;
    height: auto !important;
    max-height: 300px !important;
    margin-bottom: 30px !important;
  }
  
  div.container-fluid:first-of-type {
    padding: 20px !important;
  }
}
/* ===================== BOT√ìN FLOTANTE UNIVERSIDAD ===================== */
#uv-button {
  position: fixed;
  bottom: 25px;
  right: 25px;   /* c√°mbialo a left:25px si lo quieres a la izquierda */
  width: 70px;
  height: 70px;
  border-radius: 50%;
  background: white;
  box-shadow: 0 6px 18px rgba(0,0,0,0.25);
  display: flex;
  justify-content: center;
  align-items: center;
  cursor: pointer;
  z-index: 9999;
  transition: transform 0.3s ease;
  overflow: hidden;
}

#uv-button:hover {
  transform: scale(1.1);
}

/* Imagen interna */
#uv-button img {
  width: 80%;
  height: 80%;
  object-fit: contain;
  transition: opacity .4s ease;
}

/* Animaci√≥n de rotaci√≥n */
@keyframes spin-logo {
  0% { transform: rotate(0deg); }
  100% { transform: rotate(360deg); }
}

#uv-button.spin {
  animation: spin-logo 1.2s linear;
}
#uv-button img {
  width: 80%;
  height: 80%;
  object-fit: contain;
  display: block;
  margin: auto;        
  position: absolute;  
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
}
/* ===== TOOLTIP PERSONALIZADO PARA EL BOT√ìN ===== */
/* ===== TOOLTIP HACIA LA IZQUIERDA ===== */
#uv-button::after {
  content: attr(data-tooltip);
  position: absolute;
  left: -10px;                /* empieza pegado al borde izquierdo */
  top: 50%;                   /* centrado verticalmente */
  transform: translate(-100%, -50%);  /* lo desplaza completamente a la izquierda */
  
  background: rgba(0,0,0,0.85);
  color: white;
  padding: 8px 12px;
  font-size: 0.85em;
  border-radius: 6px;
  white-space: nowrap;
  opacity: 0;
  pointer-events: none;
  transition: opacity 0.25s ease;
}

#uv-button:hover::after {
  opacity: 1;
}

#uv-button {
  position: fixed !important;
  z-index: 999999 !important;
  pointer-events: auto !important;
}
#custom-toc, #right-toc {
  z-index: 5000 !important;
}
#uv-button {
  overflow: visible !important;
}

/* ========== NUEVO: ESTILO PARA EL BOT√ìN INDIVIDUAL DE CADA CHUNK ========== */
.chunk-code-toggle {
  background-color: transparent;
  color: var(--accent-primary); /* Color verde/cian */
  border: 1px solid var(--accent-primary);
  padding: 4px 10px;
  border-radius: 6px;
  cursor: pointer;
  font-family: 'Inter', sans-serif;
  font-size: 0.85rem;
  font-weight: 600;
  margin-bottom: 5px; /* Espacio entre bot√≥n y c√≥digo */
  margin-top: 15px;   /* Espacio respecto al elemento anterior */
  transition: all 0.2s ease;
  display: inline-flex;
  align-items: center;
  gap: 5px;
}

.chunk-code-toggle:hover {
  background-color: var(--accent-primary);
  color: white;
  box-shadow: 0 4px 10px rgba(0, 184, 148, 0.2);
}

.chunk-code-toggle.active {
  background-color: var(--bg-lighter);
  color: var(--text-gray);
  border-color: var(--text-gray);
}

/* Ajuste para que el bloque de c√≥digo (pre) aparezca pegado al bot√≥n */
pre {
  margin-top: 0 !important;
  transition: all 0.3s ease;
}
/* ========== CENTRADO UNIVERSAL DE GR√ÅFICOS E IM√ÅGENES ========== */

/* 1. Centra im√°genes est√°ticas (tanto Markdown como HTML <img>) */
img {
display: block;
 margin-left: auto;
 margin-right: auto;
}

/* 2. Centra contenedores de figuras generados por R (gr√°ficos est√°ticos) */
.r-figure {
 display: block;
 margin-left: auto;
 margin-right: auto;
 max-width: 900px; /* O el ancho m√°ximo que desees */
}

/* 3. Centra contenedores de plotly (incluye ggplotly) */
.html-widget.plotly {
 display: block;
 margin: 0 auto !important;
 max-width: 900px; /* O el ancho m√°ximo que desees */
}
/* 4. Centra tblas (kable / kableExtra) igual que plotly */
table, .table, table.kable_wrapper {
    margin-left: auto !important;
    margin-right: auto !important;
    max-width: 900px; /* Mismo ancho m√°ximo que tus gr√°ficos */
    width: auto !important; /* Evita que la tabla se estire al 100% si es peque√±a */
    border-collapse: collapse; /* Opcional: para que se vea limpia */
}
</style>
```
<div id="uv-button" data-tooltip="Escuela de Ingenier√≠a Industrial - Cali">
  <img id="uv-img" src="univalle.png" alt="Univalle">
</div>

```{=html}
<script>
document.addEventListener('DOMContentLoaded', function() {
  const SCROLL_OFFSET = 100; // Ajusta este valor si el t√≠tulo queda tapado (100px es bueno)
  
  // 1. REFERENCIA AL CONTENEDOR DEL TOC
  const toc = document.getElementById("custom-toc");
  if (!toc) return; // Si no existe el div, no hace nada

  // 2. CREAR T√çTULO Y LISTA
  const title = document.createElement("h2");
  title.textContent = "Contenido";
  toc.appendChild(title);
  
  const list = document.createElement("ul");
  toc.appendChild(list);

  // 3. GENERAR ENLACES BASADOS EN H1 y H2
  const headers = document.querySelectorAll("h1, h2");
  
  headers.forEach(header => {
    // Si el header no tiene ID, creamos uno limpio
    if (!header.id) {
      header.id = header.textContent
        .toLowerCase()
        .replace(/[^a-z0-9]+/g, "-") // Reemplaza caracteres raros por guiones
        .replace(/^-+|-+$/g, '');    // Quita guiones al inicio o final
    }

    // Crear el elemento de lista
    const li = document.createElement("li");
    const a = document.createElement("a");
    
    a.href = `#${header.id}`; // Enlace interno al ID
    a.textContent = header.textContent; // Texto del enlace
    
    // === AQU√ç EST√Å LA MAGIA DEL CLIC ===
    a.addEventListener('click', function(e) {
      e.preventDefault(); // Evita el salto brusco predeterminado
      
      const targetId = this.getAttribute('href').substring(1); // Quita el #
      const targetElement = document.getElementById(targetId);
      
      if (targetElement) {
        // Scroll suave manual
        window.scrollTo({
          top: targetElement.offsetTop - SCROLL_OFFSET, 
          behavior: 'smooth'
        });
        
        // Actualizar URL sin saltar (opcional)
        history.pushState(null, null, `#${targetId}`);
      }
    });

    li.appendChild(a);
    list.appendChild(li);
  });

  // 4. RESALTAR ENLACE ACTIVO AL HACER SCROLL
  function updateActiveTOCLink() {
    const tocLinks = document.querySelectorAll('#custom-toc a');
    let currentActiveId = '';
    
    headers.forEach(section => {
      const rect = section.getBoundingClientRect();
      // Si la secci√≥n est√° cerca de la parte superior (con el offset)
      if (rect.top <= SCROLL_OFFSET + 20) { 
        currentActiveId = section.id;
      }
    });
    
    tocLinks.forEach(link => {
      link.classList.remove('active');
      if (link.getAttribute('href') === `#${currentActiveId}`) {
        link.classList.add('active');
      }
    });
  }

  // 5. EVENTOS GLOBALES
  window.addEventListener('scroll', updateActiveTOCLink);
  // Ejecutar una vez al inicio para marcar el primero
  updateActiveTOCLink(); 

  // --- EXTRAS (FECHA, BOT√ìN, ETC) ---
  
  // Fecha
  const fechaSpan = document.getElementById('fecha-entrega');
  if(fechaSpan) {
    fechaSpan.textContent = new Date().toLocaleDateString('es-ES', {
      year: 'numeric', month: 'long', day: 'numeric'
    });
  }

  // Bot√≥n C√≥digo
  const btnToggle = document.createElement('button');
  btnToggle.id = 'global-code-toggle';
  btnToggle.textContent = 'üíª C√≥digo Oculto';
  document.body.appendChild(btnToggle);
  let codeVisible = true;
  btnToggle.addEventListener('click', function() {
    const codes = document.querySelectorAll('pre');
    codeVisible = !codeVisible;
    codes.forEach(code => {
      code.style.display = codeVisible ? 'block' : 'none';
    });
    btnToggle.textContent = codeVisible ? 'üíª C√≥digo Oculto' : 'üëÅÔ∏è Mostrar C√≥digo';
  });

  // Animaci√≥n Logo Univalle
  const logos = ["univalle.png", "ingenieria.png"];  
  let index = 0;
  const img = document.getElementById("uv-img");
  const btn = document.getElementById("uv-button");
  if (btn && img) {
    setInterval(() => {
      btn.classList.add("spin");
      setTimeout(() => {
        index = (index + 1) % logos.length;
        img.style.opacity = 0;
        setTimeout(() => {
          img.src = logos[index];
          img.style.opacity = 1;
        }, 200);
      }, 600);
      setTimeout(() => btn.classList.remove("spin"), 1200);
    }, 3500);
  }
});
document.addEventListener('DOMContentLoaded', function() {
  const SCROLL_OFFSET = 100;

 
  // --- 2. NUEVA L√ìGICA: BOTONES INDIVIDUALES PARA CADA C√ìDIGO ---
  
  // Seleccionamos todos los bloques de c√≥digo generados por R
  // R Markdown suele ponerlos en 'pre.r' o dentro de div.sourceCode
  const codeBlocks = document.querySelectorAll('pre.r, pre.sourceCode, .sourceCode pre');

  codeBlocks.forEach(block => {
    // 1. Ocultar el c√≥digo por defecto
    block.style.display = 'none';

    // 2. Crear el bot√≥n
    const btn = document.createElement('button');
    btn.className = 'chunk-code-toggle';
    btn.innerHTML = '<span>&#9654;</span> Ver C√≥digo'; // Icono de play
    
    // 3. Insertar el bot√≥n ANTES del bloque de c√≥digo
    // Buscamos el padre para insertar antes del <pre>
    block.parentNode.insertBefore(btn, block);

    // 4. Agregar evento click
    btn.addEventListener('click', function() {
      if (block.style.display === 'none') {
        // Mostrar
        block.style.display = 'block';
        btn.innerHTML = '<span>&#9660;</span> Ocultar C√≥digo';
        btn.classList.add('active');
      } else {
        // Ocultar
        block.style.display = 'none';
        btn.innerHTML = '<span>&#9654;</span> Ver C√≥digo';
        btn.classList.remove('active');
      }
    });
  });

  // --- 3. EXTRAS (FECHA, LOGOS) ---
  const fechaSpan = document.getElementById('fecha-entrega');
  if(fechaSpan) {
    fechaSpan.textContent = new Date().toLocaleDateString('es-ES', {
      year: 'numeric', month: 'long', day: 'numeric'
    });
  }

  // Elimin√© el bot√≥n global anterior para que no tengas conflicto, 
  // ya que ahora tienes botones individuales.

  // Animaci√≥n Logo Univalle
  const logos = ["univalle.png", "ingenieria.png"];  
  let index = 0;
  const img = document.getElementById("uv-img");
  const btn = document.getElementById("uv-button");
  if (btn && img) {
    setInterval(() => {
      btn.classList.add("spin");
      setTimeout(() => {
        index = (index + 1) % logos.length;
        img.style.opacity = 0;
        setTimeout(() => {
          img.src = logos[index];
          img.style.opacity = 1;
        }, 200);
      }, 600);
      setTimeout(() => btn.classList.remove("spin"), 1200);
    }, 3500);
  }
});
</script>

```
```{r setup-theme, include=FALSE}
library(ggplot2)
library(forecast)
library(tseries)

tesla_pal <- list(
  bg        = "#ffffff",    # Tu --bg-li
  text_main = "#1f2937",    # Tu --text-dark
  text_gray = "#4b5563",    # Tu --text-medium
  primary   = "#00b894",    # Tu --accent-primary (Verde/Cian principal)
  secondary = "#06b6d4",    # Tu --accent-secondary (Cian claro)
  positive  = "#84cc16",    # Tu --accent-positive
  negative  = "#e17055",    # Tu --accent-negative
  grid      = "#f3f4f6"     # Un gris muy sutil para las rejillas
)

theme_tesla <- function() {
  theme_minimal(base_size = 14) +
    theme(
      plot.background = element_rect(fill = "transparent", color = NA),
      panel.background = element_rect(fill = "transparent", color = NA),
      text = element_text(color = tesla_pal$text_main, family = "sans"),
      plot.title = element_text(face = "bold", size = 16, color = tesla_pal$text_main, margin = margin(b = 10)),
      plot.subtitle = element_text(size = 12, color = tesla_pal$secondary, margin = margin(b = 10)),
      plot.caption = element_text(size = 9, color = tesla_pal$text_gray, margin = margin(t = 10)),
      axis.title = element_text(face = "bold", size = 11, color = tesla_pal$text_gray),
      axis.text = element_text(size = 10, color = tesla_pal$text_gray),
      axis.line.x = element_line(color = tesla_pal$secondary, size = 0.5), 
      panel.grid.major = element_line(color = tesla_pal$grid, linetype = "dashed"),
      panel.grid.minor = element_blank(),
      legend.position = "bottom",
      legend.background = element_rect(fill = "transparent", color = NA),
      legend.key = element_rect(fill = "transparent", color = NA)
    )
}

theme_set(theme_tesla())

update_geom_defaults("line", list(color = tesla_pal$primary, size = 1.1))
update_geom_defaults("point", list(color = tesla_pal$secondary, size = 2))
update_geom_defaults("col", list(fill = tesla_pal$primary, color = NA))

```
---

# An√°lisis de Series de Tiempo y Pron√≥sticos ARIMA

Estudio Emp√≠rico sobre el Precio de Acciones de Tesla Inc.

---

# 1. Introducci√≥n

## 1.1 Relevancia del An√°lisis



## 1.2 Metodolog√≠a: Modelos ARIMA


---

# 2. An√°lisis descriptivo

En esta secci√≥n se presenta un an√°lisis descriptivo exhaustivo de la serie hist√≥rica del ETF QQQ (Invesco QQQ Trust) ‚Äîutilizado aqu√≠ como proxy del desempe√±o conjunto de las empresas del Nasdaq-100‚Äî recuperada program√°ticamente desde Yahoo Finance. La serie cubre desde el 1 de mayo de 1999 hasta 2025 y trabaja en frecuencia diaria; la variable base es el precio de cierre ajustado, a partir del cual se calculan rendimientos, logar√≠tmicos diarios, mensuales y anuales, as√≠ como medidas de riesgo y desempe√±o.
El prop√≥sito central de este bloque es ofrecer una visi√≥n integrada y reproducible de (i) la evoluci√≥n temporal acumulada del precio del QQQ, (ii) la estructura actual del instrumento ‚Äîpor sectores y principales holdings‚Äî y (iii) un conjunto de estad√≠sticas descriptivas y m√©tricas financieras que cuantifiquen nivel, dispersi√≥n, asimetr√≠a, colas y riesgos extremos. 
Las visualizaciones incluyen gr√°ficos interactivos para facilitar la exploraci√≥n temporal, un gr√°fico de asignaci√≥n sectorial, un diagrama de empaquetamiento circular para las mayores participaciones, histogramas y densidades de retornos, boxplots por a√±o, heatmap estacional mensual y comparaciones normalizadas frente a otros ETFs de mercado . Adem√°s, se presenta un resumen anual con volatilidad y drawdown por a√±o para identificar episodios de estr√©s y recuperaci√≥n, as√≠ como una cronolog√≠a de hitos tecnol√≥gicos relevantes que permite contextualizar inflexiones recientes en la din√°mica del QQQ.
La interpretaci√≥n de los resultados prioriza tres ejes: nivel y tendencia de largo plazo, din√°mica de riesgo (volatilidad y drawdowns) y concentraci√≥n (sectorial y por holdings), con el objetivo de brindar una base s√≥lida para cualquier an√°lisis inferencial o de modelado posterior.

## 2.1.1 serie QQQ historica 

```{r serie, echo=TRUE, warning=FALSE, message=FALSE}
library(tidyquant)
library(tidyverse)
library(ggplot2)
library(zoo)
library(plotly)

serie <- getSymbols('QQQ', src='yahoo', auto.assign=FALSE, from="1999-05-01")
precios <- serie$QQQ.Close
datos_qqq <- data.frame(
  Fecha = index(precios),
  Precio = as.numeric(precios)
)
datos_qqq <- datos_qqq %>%
  mutate(Corte = as.yearqtr(Fecha)) 
lista_frames <- lapply(unique(datos_qqq$Corte), function(c) {
  dt <- datos_qqq[datos_qqq$Corte <= c, ]
  dt$Frame <- as.character(c) 
  return(dt)
})

datos_animados <- dplyr::bind_rows(lista_frames)
p <- ggplot(datos_animados, aes(x = Fecha, y = Precio)) +
  
  geom_area(aes(frame = Frame), fill = tesla_pal$primary, alpha = 0.1, position = "identity") +
  
  geom_line(aes(frame = Frame), color = tesla_pal$primary, size = 0.8) +
  
  labs(
    title = "Evoluci√≥n Din√°mica del QQQ",
    subtitle = "Crecimiento hist√≥rico acumulado",
    x = "", 
    y = "Precio (USD)"
  ) +
  scale_y_continuous(labels = scales::dollar_format()) +
  theme_tesla() +
  theme(plot.title = element_text(size = 14))

plotly::ggplotly(p, tooltip = c("x", "y")) %>%
  plotly::layout(
    paper_bgcolor = 'rgba(0,0,0,0)',
    plot_bgcolor = 'rgba(0,0,0,0)',
    font = list(family = "Inter, sans-serif", color = tesla_pal$text_gray),
    hovermode = "x unified"
  ) %>%
  plotly::animation_opts(
    frame = 100,       
    transition = 0,    
    redraw = FALSE     
  ) %>%
  plotly::animation_slider(
    currentvalue = list(prefix = "Periodo: ") 
  ) %>%
  plotly::config(displayModeBar = FALSE)
```

## 3.1 Resumen anual

```{r resumen_anual_tabla, echo=TRUE, warning=FALSE, message=FALSE}
library(dplyr)
library(tidyr)

df_ann <- data.frame(Fecha = index(ret_anual), Ret = as.numeric(ret_anual))
df_ann <- df_ann %>% mutate(A√±o = lubridate::year(Fecha), RetPct = Ret * 100)
vol_year <- ret_diario %>% 
  data.frame(Fecha = index(ret_diario), Ret = as.numeric(ret_diario)) %>%
  mutate(A√±o = lubridate::year(Fecha)) %>%
  group_by(A√±o) %>%
  summarise(Vol = sd(Ret, na.rm=TRUE)*sqrt(252)*100, Ret = sum(Ret)*100)
dd_df <- data.frame(Fecha = index(ret_diario), Ret = as.numeric(ret_diario))
dd_df <- dd_df %>% mutate(A√±o = lubridate::year(Fecha))
maxdd_yr <- dd_df %>% group_by(A√±o) %>%
  summarise(MaxDD = min( cumprod(1+Ret) / cummax(cumprod(1+Ret)) - 1 ) * 100)

res_yr <- left_join(vol_year, maxdd_yr, by = "A√±o") %>% arrange(desc(A√±o))
knitr::kable(res_yr, format = "html")
```

La evoluci√≥n hist√≥rica del QQQ muestra una tendencia alcista secular con crecimiento claramente exponencial: el precio ha pasado de niveles inferiores a los 100 USD en el a√±o 2000 a superar los 600 USD en 2025, revelando una din√°mica de crecimiento compuesto que justifica el uso de rendimientos logar√≠tmicos para evitar distorsiones visuales y estad√≠sticas en series con fuerte convexidad (Tsay, 2010). A lo largo de esta trayectoria se observan episodios de estr√©s que estructuran la narrativa de riesgo: el colapso de la Burbuja Dot-Com (2000‚Äì2002), cuyo drawdown tard√≥ m√°s de una d√©cada en recuperarse, constituye un ejemplo protot√≠pico de riesgo de cola y rupturas prolongadas de tendencia (Malkiel, 2003); la Crisis Financiera de 2008 introduce un segundo punto de inflexi√≥n, seguido a√±os despu√©s por la correcci√≥n de 2022 asociada al ciclo de aumentos de tasas de la Reserva Federal. Estos episodios confirman que la volatilidad no es constante, sino que se concentra en periodos espec√≠ficos, tal como lo sugiere la literatura cl√°sica sobre colas pesadas y agrupamiento de volatilidad (Mandelbrot, 1963), lo que respalda el uso de densidades de retornos, m√©tricas de drawdown y boxplots anuales como parte del an√°lisis descriptivo. En el extremo derecho del gr√°fico ‚Äîel periodo 2023-2025‚Äî aparece una aceleraci√≥n sin precedentes atribuible al auge de la inteligencia artificial generativa, fen√≥meno coherente con la ‚Äúcronolog√≠a de hitos tecnol√≥gicos‚Äù mencionada en el an√°lisis y con la marcada concentraci√≥n del QQQ en mega-caps como NVIDIA, Microsoft y Apple, cuya participaci√≥n desproporcionada impulsa el √≠ndice (Invesco, 2024). En conjunto, la trayectoria refleja una combinaci√≥n de convexidad positiva de largo plazo, episodios de estr√©s profundos y una creciente concentraci√≥n tecnol√≥gica, elementos que explican simult√°neamente su alto retorno hist√≥rico y su exposici√≥n a volatilidad extrema.

## 2.1.2 Divisi√≥n sectorial 


```{r tortA, echo=TRUE, warning=FALSE, message=FALSE}
library(plotly)
sectores <- data.frame(
  Sector = c("Tecnolog√≠a", "Consumo Discrecional", "Servicios de Comunicaci√≥n", 
             "Consumo B√°sico", "Industriales", "Salud", "Otros", 
             "Servicios P√∫blicos", "Materiales", "Energ√≠a"),
  Peso = c(53.60, 13.04, 12.61, 4.99, 4.58, 4.28, 3.22, 1.38, 1.25, 0.47)
)

colores_sector <- c(
  "#2b5c8a",
  "#5d5b94", 
  "#8e6fa3",
  "#c46d9e",
  "#e67586", 
  "#f38972", 
  "#f8a262",
  "#fbc058", 
  "#fce05d", 
  "#34495e"  
)
fig_pie <- plot_ly(sectores, labels = ~Sector, values = ~Peso, type = 'pie',
        textposition = 'outside',      
        textinfo = 'label+percent',    
        hoverinfo = 'label+value+percent',
        marker = list(
          colors = colores_sector, 
          line = list(color = '#ffffff', width = 1.5) 
        ),
        sort = FALSE, 
        automargin = TRUE
)

fig_pie <- fig_pie %>% layout(
  title = list(
    text = "<b>Asignaci√≥n Sectorial</b>",
    font = list(size = 22, family = "Poppins, sans-serif", color = tesla_pal$text_main),
    x = 0.05, 
    y = 0.95
  ),
  showlegend = FALSE, 
  margin = list(t = 80, b = 40, l = 80, r = 80), 
  paper_bgcolor = 'rgba(0,0,0,0)',
  plot_bgcolor = 'rgba(0,0,0,0)',
  font = list(family = "Inter, sans-serif", size = 12, color = tesla_pal$text_gray)
)

fig_pie

```

El gr√°fico de Asignaci√≥n Sectorial ratifica la identidad del QQQ no como un √≠ndice de mercado amplio, sino como un veh√≠culo de inversi√≥n tem√°tico con un sesgo factorial expl√≠cito: el sector Tecnolog√≠a ejerce una hegemon√≠a absoluta sobre la estructura del fondo, acaparando el 53.9% de los activos netos. Esta concentraci√≥n masiva desborda los l√≠mites tradicionales de la diversificaci√≥n sectorial, convirtiendo al ETF en un instrumento altamente sensible a los ciclos de innovaci√≥n y a las revisiones de valoraci√≥n espec√≠ficas de la industria tecnol√≥gica.

Esta preponderancia se ve magnificada por la correlaci√≥n estrat√©gica de los sectores secundarios: Consumo Discrecional (13.1%) y Servicios de Comunicaci√≥n (12.7%) ocupan el segundo y tercer lugar respectivamente. Desde una perspectiva fundamental, esta distribuci√≥n es enga√±osa, pues gran parte de los componentes de estos sectores (como Amazon en consumo o Alphabet/Meta en comunicaci√≥n) operan bajo din√°micas digitales similares a las tecnol√≥gicas puras. En consecuencia, cerca del 80% del portafolio se encuentra expuesto al factor Growth (Crecimiento), lo que implica una alta sensibilidad a la liquidez del mercado y al apetito por riesgo, distanci√°ndose de la estructura m√°s balanceada que ofrecen √≠ndices generalistas como el S&P 500 (MSCI, 2023).

Por el contrario, la participaci√≥n marginal de sectores defensivos y antic√≠clicos ‚Äîcomo Consumo B√°sico (5.02%), Salud (4.3%), Industriales (4.61%) y las asignaciones residuales en Servicios P√∫blicos (1.39%) y Energ√≠a (0.473%)‚Äî sugiere que el QQQ carece de los "amortiguadores" tradicionales contra la volatilidad macroecon√≥mica. Esta asimetr√≠a estructural dota al portafolio de una elevada duraci√≥n de acciones impl√≠cita, haci√©ndolo mec√°nicamente vulnerable a las variaciones en la tasa de descuento (tasas de inter√©s), una caracter√≠stica que explica la severidad de las correcciones observadas en 2022 cuando el costo del capital se increment√≥ (Bernstein, 1997).

## 2.3 Mayores Holdings 

```{r top10, echo=TRUE, warning=FALSE, message=FALSE}

library(packcircles)
library(dplyr)
library(ggplot2)
library(plotly)

top10 <- data.frame(
  ticker = c("NVDA","AAPL","MSFT","AVGO","AMZN","GOOGL","GOOG","TSLA","META","NFLX"),
  empresa = c("NVIDIA","Apple Inc.","Microsoft","Broadcom Inc.","Amazon.com, Inc.",
              "Alphabet Class A","Alphabet Class C","Tesla, Inc.","Meta Plataformas, Inc.","Netflix, Inc."),
  peso = c(9.33, 8.78, 7.69, 6.59, 5.21, 3.97, 3.71, 3.31, 2.93, 2.36),
  sector = c("Tecnolog√≠a","Tecnolog√≠a","Tecnolog√≠a","Tecnolog√≠a",
             "Consumo","Comunicaci√≥n","Comunicaci√≥n",
             "Consumo","Comunicaci√≥n","Consumo"),
  stringsAsFactors = FALSE
)

otros_val <- round(100 - sum(top10$peso), 2)
holdings <- bind_rows(top10,
                      data.frame(ticker="OTROS", empresa="Resto del QQQ",
                                 peso = otros_val, sector="Varios", stringsAsFactors = FALSE)) %>%
  arrange(desc(peso))

packing <- circleProgressiveLayout(holdings$peso, sizetype='area')
holdings_pack <- cbind(holdings, packing)
holdings_pack$id <- seq_len(nrow(holdings_pack))
holdings_pack <- holdings_pack %>% rename(center_x = x, center_y = y)

dat.gg <- circleLayoutVertices(packing, npoints = 100)
dat.gg <- merge(dat.gg, holdings_pack, by = "id")

holdings_pack <- holdings_pack %>%
  mutate(
    peso_label = gsub("\\.", ",", formatC(peso, digits = 2, format = "f")),
    hover_text = paste0(
      empresa, "\n",
      "Ticker: ", ticker, "\n",
      "Peso: ", peso_label, "%\n",
      "Sector: ", sector
    ),
    label_text = ifelse(peso >= 2.3, paste0(ticker, "\n", peso_label, "%"), "")
  )

fill_map <- c(
  "Tecnolog√≠a"   = tesla_pal$primary,
  "Consumo"      = tesla_pal$secondary,
  "Comunicaci√≥n" = "#3b82f6",
  "Varios"       = tesla_pal$text_gray
)

p_bubble <- ggplot() +
  geom_polygon(
    data = dat.gg,
    aes(x = x, y = y, group = id, fill = sector,
        text = holdings_pack$hover_text[match(id, holdings_pack$id)]),
    color = "white", size = 0.5, alpha = 0.95
  ) +
  geom_text(
    data = holdings_pack,
    aes(x = center_x, y = center_y, label = label_text, text = hover_text),
    size = 3.8, color = "white", fontface = "bold", lineheight = 0.9
  ) +
  scale_fill_manual(values = fill_map) +
  theme_void() +
  coord_equal() +
  labs(title = "Composici√≥n del Portafolio QQQ",
       subtitle = "Top holdings seg√∫n la imagen") +
  theme(
    plot.title = element_text(face = "bold", size = 16, color = tesla_pal$text_main, hjust = 0.5),
    plot.subtitle = element_text(size = 12, color = tesla_pal$text_gray, hjust = 0.5),
    legend.position = "bottom",
    legend.title = element_blank(),
    plot.margin = margin(10,10,10,10)
  )

ggplotly(p_bubble, tooltip = "text") %>%
  config(displayModeBar = FALSE) %>%
  layout(
    font = list(family = "Inter", color = tesla_pal$text_main),
    plot_bgcolor  = "rgba(0,0,0,0)",
    paper_bgcolor = "rgba(0,0,0,0)",
    legend = list(orientation = "h", yanchor = "bottom", y = -0.12, xanchor = "center", x = 0.5),
    hoverlabel = list(
      bgcolor = "rgba(255,255,255,0.97)",
      bordercolor = "rgba(0,0,0,0.08)",
      font = list(family = "Inter", color = tesla_pal$text_main, size = 11)
    )
  )
```

El diagrama de empaquetamiento circular revela la estructura interna del QQQ, evidenciando una alta concentraci√≥n jer√°rquica en un n√∫mero reducido de activos de mega-capitalizaci√≥n. Visualmente, el gr√°fico confirma que el rendimiento del √≠ndice no es el resultado de una contribuci√≥n homog√©nea, sino que depende desproporcionadamente de un cl√∫ster de empresas dominantes: las diez mayores posiciones (encabezadas por NVDA, AAPL, MSFT y AVGO) representan, en conjunto, m√°s del 50% del peso total del portafolio, relegando al segmento de "Otros" (el resto de los componentes del Nasdaq-100) a una participaci√≥n minoritaria del 46.12%. Esta arquitectura de cartera contradice el principio cl√°sico de diversificaci√≥n ingenua, exponiendo al inversor a un significativo riesgo idiosincr√°tico derivado del desempe√±o individual de estos gigantes tecnol√≥gicos (Markowitz, 1952).

La distribuci√≥n sectorial refuerza el sesgo hacia la innovaci√≥n: las burbujas predominantes en color verde (Tecnolog√≠a), azul (Comunicaci√≥n) y cian (Consumo Discrecional) ilustran que el QQQ es, en esencia, una apuesta factorial hacia el crecimiento y la econom√≠a digital, con una exposici√≥n m√≠nima a sectores defensivos tradicionales. Resulta particularmente notable que NVIDIA (9.33%) haya superado a Apple (8.78%) y Microsoft (7.69%) como el componente de mayor ponderaci√≥n, un cambio estructural que valida emp√≠ricamente la hip√≥tesis planteada en el an√°lisis de precios sobre el impacto disruptivo de la Inteligencia Artificial Generativa en la valoraci√≥n de activos recientes (Fama & French, 2015).

Desde una perspectiva de gesti√≥n de riesgos, esta configuraci√≥n explica la alta beta y la convexidad observada en la serie hist√≥rica: la correlaci√≥n positiva entre estos pocos activos l√≠deres amplifica tanto los rendimientos exponenciales en mercados alcistas como la severidad de los drawdowns en periodos de correcci√≥n, confirmando que la din√°mica del QQQ est√° intr√≠nsecamente ligada a la salud financiera y las expectativas de crecimiento de este selecto grupo de empresas (Sharpe, 1964).


## 2.4 An√°lisis Estad√≠stico

```{r tabla, echo=TRUE, warning=FALSE, message=FALSE}
library(moments)
library(knitr)
library(dplyr)
serie_vec <- as.numeric(serie[,6])
serie_vec <- serie_vec[!is.na(serie_vec)]
if (max(serie_vec) > 1000) {
  warning("‚ö†Ô∏è La serie est√° por fuera del rango t√≠pico del QQQ (0‚Äì1000 USD)")
}

valores_calculados <- c(
  length(serie_vec),
  mean(serie_vec),
  median(serie_vec),
  min(serie_vec),
  max(serie_vec),
  max(serie_vec) - min(serie_vec),
  var(serie_vec),
  sd(serie_vec),
  skewness(serie_vec),
  kurtosis(serie_vec)
)

desc <- data.frame(
  M√©trica = c(
    "Observaciones Totales",
    "Media",
    "Mediana",
    "M√≠nimo",
    "M√°ximo",
    "Rango",
    "Varianza",
    "Desviaci√≥n Est√°ndar",
    "Asimetr√≠a (Skewness)",
    "Curtosis"
  ),
  Valor = format(
    round(valores_calculados, 4),
    scientific = FALSE,
    big.mark = ","
  )
)

kable(
  desc,
  format = "html",
  align = c('l', 'r'),
  table.attr = "class='table' style='width:60%; margin:auto; font-size:18px;'"
)

```

## 2.5 Rendimientos Diarios

```{r tablarendimientos, echo=TRUE, warning=FALSE, message=FALSE}
library(quantmod)
library(dplyr)
library(ggplot2)
library(tidyverse)
library(knitr)
precios <- serie$QQQ.Close
ret_diario  <- dailyReturn(precios, type = "log")
ret_mensual <- monthlyReturn(precios, type = "log")
ret_anual   <- yearlyReturn(precios, type = "log")
vol_anual <- sd(ret_diario) * sqrt(252)
resumen <- data.frame(
  Concepto = "Volatilidad Anualizada (Riesgo)",
  Valor = scales::percent(vol_anual, accuracy = 0.01)
)
kable(resumen, 
      format = "html", 
      table.attr = "class='table' style='width:50%; margin:auto;'")

```
El c√°lculo program√°tico de la volatilidad, derivado de la desviaci√≥n est√°ndar de los retornos logar√≠tmicos diarios proyectada a un horizonte de negociaci√≥n anual (sd(ret_diario) * sqrt(252)), arroja una cifra consolidada de 26.97%. Este valor no constituye meramente una medida de dispersi√≥n estad√≠stica, sino la cuantificaci√≥n escalar de la arquitectura de riesgo descrita en los apartados anteriores. Una volatilidad anualizada cercana al 27% sit√∫a al QQQ significativamente por encima del promedio hist√≥rico de √≠ndices de mercado amplio (cuyo rango est√°ndar suele oscilar entre 15% y 20%), validando num√©ricamente la tesis de la concentraci√≥n jer√°rquica del portafolio. Como se discuti√≥ en el an√°lisis de la distribuci√≥n de rendimientos, la estructura leptoc√∫rtica y las colas pesadas no son anomal√≠as, sino componentes intr√≠nsecos de este valor: el 26.97% representa el costo del riesgo idiosincr√°tico asumido al mantener una cartera donde m√°s del 50% del peso recae en un cl√∫ster reducido de mega-caps tecnol√≥gicas (Markowitz, 1952).

Al contrastar este dato con el an√°lisis de la serie hist√≥rica, se evidencia que esta m√©trica funciona como un promedio ponderado de dos reg√≠menes de mercado opuestos: los periodos de calma relativa y crecimiento org√°nico (como la d√©cada de 2010-2019) y los episodios de estallido de volatilidad identificados en la cronolog√≠a (la Burbuja Dot-Com, la Crisis Financiera de 2008 y la correcci√≥n de tasas de 2022). Estos eventos de estr√©s act√∫an como "shocks" que inflan la desviaci√≥n est√°ndar hist√≥rica, confirmando la presencia de agrupamiento de volatilidad (volatility clustering) caracter√≠stico de las series financieras no estacionarias (Mandelbrot, 1963).

En consecuencia, el nivel de 26.97% confirma la naturaleza del QQQ como un activo de alta beta y alta convexidad: ofrece la capacidad de captura de crecimiento exponencial observada en la tendencia de precios a largo plazo, pero exige al inversor tolerar una variabilidad sustancial impulsada por la sensibilidad del sector tecnol√≥gico a la tasa de descuento y a las revisiones de expectativas de crecimiento futuro (Sharpe, 1964; Black, 1976).

## 2.6 Retornos Diarios

```{r tablaretrnosentos, echo=TRUE, warning=FALSE, message=FALSE}
ret_df <- data.frame(Retorno = as.numeric(ret_diario))

ggplot(ret_df, aes(x = Retorno)) +
  geom_histogram(aes(y = ..density..), bins = 60, fill = tesla_pal$primary, alpha = 0.4) +
  geom_density(color = tesla_pal$secondary, size = 1.2) +
  labs(title = "Distribuci√≥n de los Rendimientos Diarios del QQQ",
       x = "Retorno Diario (log)", y = "Densidad") +
  theme_tesla()

```

La distribuci√≥n de los rendimientos diarios del QQQ revela una estructura estad√≠stica coherente con la arquitectura altamente concentrada del portafolio descrita en los apartados anteriores. Como muestra el gr√°fico, la curva de densidad presenta un pico pronunciado alrededor de cero y colas m√°s gruesas de lo que predecir√≠a una distribuci√≥n normal, rasgo t√≠pico de activos dominados por empresas de gran capitalizaci√≥n fuertemente correlacionadas entre s√≠.

Este patr√≥n leptoc√∫rtico ‚Äîevidenciado visualmente por la altura central desproporcionada y la presencia de observaciones extremas (tanto positivas como negativas) en los m√°rgenes‚Äî es consistente con el comportamiento de un √≠ndice no diversificado de manera homog√©nea, sino fuertemente dependiente de unos pocos motores de crecimiento. En efecto, la concentraci√≥n estructural en NVDA, AAPL, MSFT y AVGO expuesta en el diagrama de empaquetamiento circular se manifiesta directamente en la forma de la distribuci√≥n:

cuando estas compa√±√≠as se sincronizan al alza, generan acumulaci√≥n de rendimientos peque√±os y frecuentes, que estrechan la parte central de la distribuci√≥n;

pero cuando experimentan shocks idiosincr√°ticos o correcciones de m√∫ltiplos, producen movimientos abruptos de mayor magnitud, responsables de las colas pesadas observadas.

Desde una perspectiva de riesgo, esta distribuci√≥n asim√©trica confirma una alta kurtosis y la presencia de eventos de gran impacto con mayor probabilidad que la predicha por modelos cl√°sicos de media-varianza (Markowitz, 1952). Ello es coherente con el sesgo factorial descrito previamente: un ETF con exposici√≥n cercana al 80% al factor Growth y m√≠nima participaci√≥n en sectores defensivos exhibir√° de forma natural una mayor propensi√≥n a "jumps" y episodios de volatilidad concentrada.

La ligera inclinaci√≥n de la distribuci√≥n hacia rendimientos negativos ‚Äîvisible en la cola izquierda m√°s extendida‚Äî es una expresi√≥n emp√≠rica de la sensibilidad del QQQ a cambios en la tasa de descuento, propiedad tambi√©n discutida en el an√°lisis sectorial. Durante ciclos de endurecimiento monetario, los activos de larga duraci√≥n impl√≠cita (como la tecnolog√≠a de mega-capitalizaci√≥n) tienden a exhibir ca√≠das m√°s pronunciadas, lo cual explica tanto la asimetr√≠a negativa como la convexidad detectada en la serie hist√≥rica (Sharpe, 1964).

En conjunto, la forma de la distribuci√≥n no solo plasma el comportamiento estad√≠stico de los rendimientos, sino que funciona como una evidencia visual directa de la propia identidad del QQQ:
un veh√≠culo altamente concentrado, dominado por factores de crecimiento, sensible a liquidez y a ciclos tecnol√≥gicos, y estructuralmente propenso a movimientos extremos m√°s frecuentes que los esperados bajo supuestos gaussianos.



```{r boxpllot, echo=TRUE, warning=FALSE, message=FALSE}

ret_anual_df <- data.frame(
  Fecha = index(ret_diario),
  Ret = as.numeric(ret_diario),
  A√±o = format(index(ret_diario), "%Y")
)

ggplot(ret_anual_df, aes(x = A√±o, y = Ret, group = A√±o)) +
  geom_boxplot(fill = tesla_pal$primary, alpha = 0.7) +
  labs(title = "Distribuci√≥n de los Retornos Diarios por A√±o (QQQ)",
       x = "A√±o", y = "Retorno Diario") +
  theme_tesla() +
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5))

```

El gr√°fico de cajas por a√±o muestra de manera clara c√≥mo ha evolucionado la variabilidad de los retornos diarios del ETF QQQ desde 1999 hasta 2025. En los primeros a√±os, especialmente entre 1999 y 2002, se observan cajas mucho m√°s anchas y una mayor presencia de valores at√≠picos, tanto positivos como negativos. Esta dispersi√≥n refleja el contexto de la burbuja punto-com y su colapso, donde el sector tecnol√≥gico experiment√≥ altos niveles de incertidumbre y movimientos extremos. Los retornos muestran una volatilidad significativamente mayor que en el resto del periodo, evidenciada por whiskers largos y una nube densa de puntos alejados de la mediana.

A partir de 2003 y durante buena parte de la d√©cada siguiente, la distribuci√≥n anual de los retornos se vuelve m√°s estrecha. Entre 2004 y 2007, las cajas se estabilizan y los valores at√≠picos disminuyen, se√±alando un periodo de menor volatilidad en el sector tecnol√≥gico y un comportamiento m√°s predecible de la serie. No obstante, en 2008 aparece nuevamente una fuerte expansi√≥n de la dispersi√≥n: los outliers negativos son notablemente profundos y los positivos m√°s altos, lo que coincide perfectamente con la crisis financiera global. Es un a√±o donde el riesgo sistem√°tico se intensifica y el mercado reacciona con variaciones abruptas.

Durante los a√±os siguientes, especialmente entre 2009 y 2019, los retornos del QQQ muestran nuevamente un patr√≥n de estabilidad relativa. La mayor√≠a de las cajas son bajas, con medianas cercanas a cero y un rango intercuart√≠lico peque√±o, lo que sugiere un periodo prolongado de crecimiento econ√≥mico con correcciones moderadas. Sin embargo, la crisis del COVID-19 en 2020 trae un nuevo salto en la volatilidad: las cajas se expanden, aparecen retornos extremadamente negativos y tambi√©n picos positivos. Este comportamiento es caracter√≠stico de un shock global repentino, donde los mercados pasan por fases de p√°nico seguidas por fuertes rebotes.

En los a√±os m√°s recientes ‚Äî2021 a 2024‚Äî se observa una volatilidad intermedia: mayor que en el periodo 2013‚Äì2019, pero menor que en 2020 o en los a√±os de la burbuja tecnol√≥gica. Esta variabilidad puede asociarse a factores como las tasas de inter√©s elevadas, presiones inflacionarias, cambios en las pol√≠ticas monetarias y la mayor sensibilidad del sector tecnol√≥gico a estas condiciones. Aunque los retornos siguen centrados alrededor de cero, la presencia de outliers indica que el mercado contin√∫a expuesto a episodios de shocks ocasionales.

En conjunto, el gr√°fico confirma que los retornos diarios del QQQ mantienen una distribuci√≥n t√≠picamente estrecha con mediana cercana a cero, pero presentan explosiones peri√≥dicas de volatilidad asociadas a eventos macroecon√≥micos de gran escala. Este patr√≥n es caracter√≠stico de series financieras: comportamiento estable la mayor parte del tiempo, interrumpido por episodios de turbulencia. Para el an√°lisis de modelos ARIMA, esto es relevante porque estos picos de volatilidad pueden introducir heterocedasticidad y afectar la estabilidad del modelo, por lo que un an√°lisis complementario de volatilidad (p. ej., GARCH) ser√≠a apropiado si el proyecto lo requiere.

## 2.7 Rendimientos por a√±o

```{r rendimientosa√±o, echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
library(dplyr)
library(ggplot2)
library(lubridate)
ret_anual_df <- data.frame(
  A√±o = year(index(ret_anual)),
  Retorno = round(100 * as.numeric(ret_anual), 2)
)

ggplot(ret_anual_df, aes(x = factor(A√±o), y = Retorno)) +
  geom_col(fill = tesla_pal$primary) +
  geom_text(
    aes(label = paste0(Retorno, "%")),
    vjust = -0.5,
    color = tesla_pal$text_main,  
    size = 4
  ) +
  labs(title = "Retorno Anual del QQQ",
       x = "A√±o", y = "Retorno (%)") +
  theme_tesla()
```

El gr√°fico del retorno anual del QQQ permite observar con claridad c√≥mo el desempe√±o del √≠ndice tecnol√≥gico ha estado marcado por ciclos de fuertes expansiones y contracciones, coherentes con los eventos identificados previamente en el an√°lisis de retornos diarios. Los primeros a√±os, entre 2000 y 2002, muestran ca√≠das muy pronunciadas, superiores al ‚Äì40%, que coinciden con el estallido de la burbuja punto-com, un fen√≥meno ampliamente documentado en la literatura financiera (Shiller, 2000). Este periodo se caracteriza por p√©rdidas consecutivas de magnitud excepcional, reflejando un mercado extremadamente vol√°til e incierto, como tambi√©n se evidenci√≥ en la dispersi√≥n extrema del boxplot anual, consistente con la alta varianza de los retornos de activos tecnol√≥gicos se√±alada por French, Schwert y Stambaugh (1987).

Tras esta etapa, el QQQ muestra episodios de recuperaci√≥n significativos, como en 2003 (40.29%) y especialmente en 2009 (43.07%), a√±o en el que el mercado rebota despu√©s de la crisis financiera global. No obstante, la ca√≠da abrupta de 2008 (‚Äì54.36%) resalta como uno de los peores a√±os de toda la serie, reafirmando la alta sensibilidad del sector tecnol√≥gico a choques sist√©micos, tal como ha sido analizado en estudios sobre riesgo sist√©mico y contagio financiero (Acharya et al., 2010). Estos resultados son coherentes con el patr√≥n observado en los retornos diarios: periodos largos de estabilidad interrumpidos por shocks severos.

Entre 2010 y 2019 se observa una etapa de crecimiento sostenido, donde la mayor√≠a de los a√±os presentan retornos positivos, algunos de ellos muy elevados, como 2013 (32.08%) y 2019 (38.91%). Esta d√©cada fue una de las m√°s s√≥lidas para el sector tecnol√≥gico, impulsada por avances en plataformas digitales, inteligencia artificial temprana, redes m√≥viles y expansi√≥n de las grandes empresas tecnol√≥gicas, lo cual se relaciona con la tendencia de crecimiento persistente de activos con alta innovaci√≥n documentada por Brynjolfsson y McAfee (2014). La estabilidad reflejada en los boxplots de estos a√±os coincide con un mercado maduro y menos propenso a oscilaciones extremas en comparaci√≥n con d√©cadas pasadas.

En 2020, marcado por la pandemia de COVID-19, el QQQ muestra un fuerte crecimiento del 43.04%, resultado del incremento en la demanda de servicios digitales, teletrabajo y compa√±√≠as tecnol√≥gicas en general, un comportamiento consistente con el ‚Äúefecto digitalizaci√≥n acelerada‚Äù descrito por Barrero, Bloom y Davis (2021). Sin embargo, al a√±o siguiente (2022) aparece una ca√≠da significativa del ‚Äì40.15%, asociada al aumento de tasas de inter√©s, inflaci√≥n elevada y el ajuste de valoraciones del sector tecnol√≥gico, en l√≠nea con los efectos que describe el modelo de valoraci√≥n de activos bajo cambios en pol√≠tica monetaria (Bernanke & Kuttner, 2005). Esta ca√≠da vuelve a reflejarse en la ampliaci√≥n de la volatilidad observada en el boxplot para ese periodo.

Finalmente, los a√±os m√°s recientes (2023‚Äì2025) exhiben retornos positivos moderados (entre 18% y 22%), lo que sugiere un periodo de recuperaci√≥n y estabilizaci√≥n despu√©s del fuerte ajuste de 2022. Estos valores est√°n alineados con un mercado que contin√∫a creciendo, aunque en un contexto m√°s cauteloso, influenciado por pol√≠ticas monetarias restrictivas y cambios estructurales en el sector tecnol√≥gico.

En conjunto, el gr√°fico muestra que el QQQ es un activo con alto potencial de crecimiento, pero tambi√©n con eventos peri√≥dicos de riesgo elevado, caracter√≠stica t√≠pica de los mercados tecnol√≥gicos. Este comportamiento es coherente con los patrones detectados en los boxplots y con la naturaleza no estacionaria de las series financieras, lo que justifica la importancia de t√©cnicas como ARIMA para modelar tendencias (Box & Jenkins, 1976), complementadas ‚Äîcuando sea necesario‚Äî con modelos de volatilidad como GARCH para capturar la heterocedasticidad inherente a este tipo de datos (Engle, 1982).

## 2.8 Drawdown 

```{r drawdown, echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
library(PerformanceAnalytics)
library(ggplot2)
library(dplyr)
ret_diario <- dailyReturn(precios, type = "log")

dd <- PerformanceAnalytics::Drawdowns(ret_diario)
dd_df <- data.frame(
  Fecha = index(dd),
  Drawdown = as.numeric(dd)
)
ggplot(dd_df, aes(x = Fecha, y = Drawdown)) +
  geom_line(color = tesla_pal$primary, linewidth = 0.7) +
  labs(title = "Drawdown Hist√≥rico del QQQ",
       x = "", y = "Drawdown") +
  scale_y_continuous(labels = scales::percent_format(accuracy = 1)) +
  theme_tesla()
```

El gr√°fico de drawdown hist√≥rico del QQQ revela de manera clara la profundidad y duraci√≥n de las p√©rdidas relativas del √≠ndice respecto a sus m√°ximos previos, lo que permite evaluar no solo la volatilidad, sino tambi√©n la resiliencia del mercado tecnol√≥gico a lo largo del tiempo. El periodo m√°s cr√≠tico se observa al inicio de la serie, entre 2000 y 2002, cuando el √≠ndice sufre un colapso superior al ‚Äì80% tras el estallido de la burbuja punto-com. Esta ca√≠da extraordinaria es consistente con el comportamiento descrito anteriormente en los retornos anuales, donde se evidenciaron p√©rdidas consecutivas cercanas al ‚Äì40%, un fen√≥meno ampliamente documentado en la literatura sobre burbujas especulativas (Shiller, 2000). Adem√°s, la prolongada permanencia del QQQ en drawdowns profundos durante casi una d√©cada subraya la fragilidad estructural del sector tecnol√≥gico en ese momento, caracterizado por valoraciones excesivas y escaso respaldo en flujos de caja reales.

Posteriormente, a partir de 2009, se aprecia un proceso de recuperaci√≥n sostenida que coincide con la salida de la crisis financiera global. Aunque 2008 marc√≥ un drawdown cercano al ‚Äì54%, el repunte inmediato del 2009, previamente resaltado en los retornos anuales, refleja el retorno gradual de la confianza en los mercados, fen√≥meno que la literatura asocia con pol√≠ticas monetarias expansivas y medidas de estabilizaci√≥n financiera (Bernanke & Gertler, 2001). No obstante, el drawdown de este per√≠odo tambi√©n destaca que, aunque el mercado se recupera, la profundidad de la ca√≠da anterior prolonga el tiempo de retorno a un m√°ximo hist√≥rico, reforzando la idea de que el drawdown no solo mide p√©rdidas, sino tambi√©n la duraci√≥n del proceso de recuperaci√≥n (time to recovery).

Entre 2010 y 2020, el gr√°fico muestra una notable estabilidad relativa del QQQ, con drawdowns m√°s moderados y recuperaciones m√°s r√°pidas. Este comportamiento coincide con la fase de crecimiento sostenido observada en los retornos anuales, impulsada por la expansi√≥n de las grandes empresas tecnol√≥gicas, avances en inteligencia artificial, comercio digital y servicios en la nube. Este patr√≥n es coherente con estudios que evidencian la creciente madurez y resistencia del sector tecnol√≥gico durante esta d√©cada (Brynjolfsson & McAfee, 2014). En este periodo, las ca√≠das existen, pero ninguna se aproxima a los extremos vividos en las d√©cadas previas, indicando una mayor solidez estructural del √≠ndice.

El gr√°fico tambi√©n evidencia un drawdown significativo durante la pandemia de COVID-19 en 2020, aunque de corta duraci√≥n. A diferencia de crisis anteriores, el QQQ experimenta una ca√≠da r√°pida, seguida de una recuperaci√≥n igual de acelerada, fen√≥meno asociado a la digitalizaci√≥n abrupta de la econom√≠a, que impuls√≥ fuertemente la demanda por empresas tecnol√≥gicas (Barrero, Bloom & Davis, 2021). Este comportamiento refuerza la idea de que el QQQ posee una estructura sectorial que se beneficia de shocks que incrementan la dependencia digital, lo que explica la r√°pida salida del drawdown.

Finalmente, el periodo 2022‚Äì2023 muestra un nuevo episodio de drawdown profundo, aunque no tan extremo como los hist√≥ricos, alcanzando niveles cercanos al ‚Äì35%. Esta ca√≠da coincide con el ajuste de valoraciones provocado por el aumento de tasas de inter√©s, la inflaci√≥n elevada y la contracci√≥n monetaria global. Estos shocks afectan especialmente a activos de crecimiento como los tecnol√≥gicos, cuyo valor presente es altamente sensible a cambios en las tasas de descuento, en l√≠nea con los argumentos del modelo CAPM y la literatura sobre sensibilidad de activos de crecimiento a tasas de inter√©s (Sharpe, 1964; Bernanke & Kuttner, 2005). Sin embargo, a diferencia de crisis anteriores, el drawdown se recupera parcialmente dentro del mismo periodo, demostrando mayor robustez del mercado tecnol√≥gico contempor√°neo.

En conjunto, el an√°lisis del drawdown confirma la narrativa construida en los gr√°ficos previos: el QQQ es un activo con un potencial de crecimiento extraordinario, pero con episodios recurrentes de ca√≠das severas que pueden prolongarse en el tiempo. Este comportamiento hace evidente la naturaleza no estacionaria y heteroced√°stica de la serie, lo cual justifica el uso de modelos ARIMA para capturar tendencias y de modelos GARCH para describir la volatilidad condicional (Engle, 1982; Bollerslev, 1986). El drawdown, por tanto, complementa los an√°lisis anteriores al mostrar no solo cu√°n fuerte cae el √≠ndice, sino cu√°nto tiempo tarda en recuperarse, un factor cr√≠tico en la gesti√≥n del riesgo financiero.

## 2.9 M√©tricas Financieras 

```{r metrics_financieras, echo=TRUE, warning=FALSE, message=FALSE}
library(PerformanceAnalytics)
library(xts)

cagr <- Return.annualized(ret_diario, scale = 252)
cumulative_return <- Return.cumulative(ret_diario)

sharpe_annual <- (mean(ret_diario, na.rm=TRUE) / sd(ret_diario, na.rm=TRUE)) * sqrt(252)
sortino <- SortinoRatio(ret_diario, MAR = 0)
max_dd <- maxDrawdown(ret_diario)

calmar <- as.numeric(cagr) / abs(as.numeric(max_dd))

metrics <- data.frame(
  M√©trica = c("CAGR (anual)", "Retorno acumulado", "Sharpe (aprx anual)", 
              "Sortino", "Max Drawdown", "Calmar"),
  Valor = c(
    scales::percent(as.numeric(cagr), accuracy = 0.01),
    scales::percent(as.numeric(cumulative_return), accuracy = 0.01),
    round(as.numeric(sharpe_annual), 3),
    round(as.numeric(sortino), 3),
    scales::percent(as.numeric(max_dd), accuracy = 0.1),
    round(as.numeric(calmar), 3)
  ),
  stringsAsFactors = FALSE
)

knitr::kable(metrics, format = "html", table.attr = "class='table' style='width:60%; margin:auto;'")
```

El presente conjunto de M√©tricas Financieras ofrece una visi√≥n sint√©tica y cuantitativa de la eficiencia, el riesgo y el rendimiento agregado de la estrategia, complementando de manera cr√≠tica los an√°lisis de retornos anuales y drawdown hist√≥rico. El Retorno Acumulado del 343.84% y la Tasa de Crecimiento Anual Compuesto (CAGR) de 5.77% validan el alto potencial de apreciaci√≥n del activo, una caracter√≠stica consistente con la fase de crecimiento sostenido observada en per√≠odos post-crisis. Estas cifras de rendimiento total confirman que, a pesar de los episodios de riesgo extremo, la estrategia o el sector subyacente posee una capacidad sustancial para generar riqueza a largo plazo.

Sin embargo, las m√©tricas ajustadas al riesgo revelan la baja eficiencia del rendimiento. El Ratio de Sharpe de 0.343 es penalizado por la alta volatilidad total, sugiriendo que el retorno est√° siendo consumido por la dispersi√≥n de los retornos, tanto al alza como a la baja. M√°s cr√≠tico a√∫n es el Ratio de Sortino, que con un valor de 0.03, indica que el riesgo de cola negativo (downside risk) ha sido desproporcionadamente alto en relaci√≥n con el rendimiento generado. Este hallazgo se alinea directamente con los eventos de p√©rdida catastr√≥fica identificados en los an√°lisis hist√≥ricos, donde las ca√≠das severas dominan el perfil de riesgo.

El indicador de riesgo extremo, el Max Drawdown, alcanza un valor extraordinariamente alto del 87.9%. Esta cifra es la manifestaci√≥n cuantitativa del colapso sufrido durante el estallido de la burbuja punto-com (2000-2002) y subraya la fragilidad estructural hist√≥rica y el riesgo de p√©rdida casi total de capital inherente al activo en sus per√≠odos m√°s cr√≠ticos. Desde la perspectiva de la gesti√≥n de riesgo, este valor define el peor escenario hist√≥rico tolerable. Finalmente, el Ratio Calmar de 0.066 relaciona el rendimiento anualizado con el Max Drawdown. Un valor tan bajo es una consecuencia directa del Max Drawdown extremo, confirmando la ineficiencia de la estrategia en t√©rminos de recuperaci√≥n del capital y reforzando la tesis de que el time to recovery tras los grandes choques puede ser prolongado y exige una tolerancia al riesgo excepcional.

En conclusi√≥n, el an√°lisis de las m√©tricas confirma la narrativa general: el activo ofrece un potencial de crecimiento robusto, evidenciado por el retorno acumulado, pero lo hace asumiendo un costo de riesgo hist√≥ricamente severo. Las bajas cifras de Sharpe y Sortino, junto con el Max Drawdown casi total, evidencian un perfil de riesgo dominado por eventos de cola, lo que implica que el modelado y la gesti√≥n de este activo deben necesariamente considerar la asimetr√≠a y la curtosis inherentes a la distribuci√≥n de sus retornos para cuantificar adecuadamente la severidad de las p√©rdidas potenciales.


```{r rolling_vol, echo=TRUE, warning=FALSE, message=FALSE}
library(zoo)

rollsd30  <- rollapply(as.numeric(ret_diario), width = 30, FUN = sd, fill = NA, align = "right")
rollsd90  <- rollapply(as.numeric(ret_diario), width = 90, FUN = sd, fill = NA, align = "right")
rollsd252 <- rollapply(as.numeric(ret_diario), width = 252, FUN = sd, fill = NA, align = "right")

df_roll <- data.frame(
  Fecha = index(ret_diario),
  vol30 = rollsd30 * sqrt(252),
  vol90 = rollsd90 * sqrt(252),
  vol252 = rollsd252 * sqrt(252)
)

library(reshape2)
dfm <- melt(df_roll, id.vars = "Fecha", variable.name = "Window", value.name = "VolAnual")

ggplot(dfm, aes(x = Fecha, y = VolAnual, color = Window)) +
  geom_line(size = 0.8) +
  scale_y_continuous(labels = scales::percent_format(accuracy = 0.1)) +
  labs(title = "Volatilidad Rolling (annualizada)", y = "Vol Annualizada", x = "") +
  scale_color_manual(values = c("vol30" = tesla_pal$primary, "vol90" = tesla_pal$secondary, "vol252" = tesla_pal$text_gray)) +
  theme_tesla()
```

El gr√°fico de volatilidad rolling (m√≥vil) desagrega temporalmente la cifra est√°tica de riesgo (26.97%) analizada previamente, proporcionando la evidencia visual definitiva de la heterocedasticidad condicional inherente a la serie del QQQ. Al observar la evoluci√≥n de la desviaci√≥n est√°ndar anualizada en distintas ventanas temporales, se confirma que el riesgo del activo no es constante, sino que exhibe un marcado comportamiento de agrupamiento de volatilidad (volatility clustering): grandes cambios en los precios tienden a ser seguidos por grandes cambios, y periodos de calma por calma, validando emp√≠ricamente los postulados de los modelos ARCH/GARCH sugeridos para la modelaci√≥n de esta serie (Engle, 1982). La estructura del gr√°fico est√° dominada por tres ‚Äúreg√≠menes de alta volatilidad‚Äù que se corresponden sim√©tricamente con los episodios de drawdown m√°ximo identificados en el an√°lisis hist√≥rico.

El primer r√©gimen, correspondiente a la persistencia de la Burbuja (2000-2003), muestra el pico m√°s ancho de la serie, donde la volatilidad anualizada supera el 75%. La l√≠nea de largo plazo (vol252) se mantiene en niveles extremos durante un periodo prolongado, lo que explica por qu√© los ratios de eficiencia (Sharpe y Calmar) son tan bajos: el riesgo no fue un evento transitorio, sino una condici√≥n estructural que erosion√≥ los retornos ajustados durante a√±os. Posteriormente, se observa el shock sist√©mico de 2008, con un segundo pico vertical que tambi√©n rompe la barrera del 75%, indicando un contagio inmediato que afect√≥ tanto la negociaci√≥n t√°ctica como la estrat√©gica (Acharya et al., 2010). En contraste, el pico de 2020 (Pandemia) es extremadamente agudo pero de base estrecha, reflejando la naturaleza ex√≥gena del shock y una estabilizaci√≥n acelerada impulsada por la digitalizaci√≥n de la econom√≠a (Barrero, Bloom & Davis, 2021).

La discrepancia entre las ventanas de estimaci√≥n de corto plazo (vol30, l√≠nea cian) y largo plazo (vol252, l√≠nea gris) ofrece una lectura sobre la ‚Äútensi√≥n‚Äù del mercado frente a su tendencia de fondo. En periodos recientes como 2022, la volatilidad de corto plazo oscila con mucha mayor amplitud que la de largo plazo, se√±alando un mercado en b√∫squeda de equilibrio ante la incertidumbre sobre el costo del capital. Esta sensibilidad valida la hip√≥tesis de la duraci√≥n de acciones: la alta concentraci√≥n en activos de crecimiento (Growth) hace que la volatilidad del QQQ reaccione de manera hipersensible a cambios en la pol√≠tica monetaria (Sharpe, 1964).

En conclusi√≥n, este gr√°fico act√∫a como el eslab√≥n que conecta la Asimetr√≠a estad√≠stica con el Max Drawdown hist√≥rico del 87.9%. Demuestra que la ‚Äúvolatilidad media‚Äù es una m√©trica enga√±osa para el QQQ, ya que el inversor rara vez experimenta el promedio; en su lugar, el activo transita entre largos periodos de volatilidad moderada y explosiones de riesgo extremo. Esta din√°mica bimodal justifica plenamente la conclusi√≥n de las m√©tricas financieras: la gesti√≥n de este activo requiere una tolerancia al riesgo excepcional, dise√±ada no para el promedio, sino para sobrevivir a los picos de varianza que definen su trayectoria a largo plazo (Mandelbrot, 1963; Bollerslev, 1986).

## 3 Estacionalidad Mensual del QQQ (1999‚Äì2025)

```{r heatmap_estacional_mejor, echo=TRUE, warning=FALSE, message=FALSE}
library(ggplot2)
library(viridis)

df_m <- data.frame(Fecha = index(ret_mensual), Ret = as.numeric(ret_mensual))
df_m <- df_m %>% mutate(A√±o = lubridate::year(Fecha), Mes = lubridate::month(Fecha, label = TRUE, abbr = TRUE), RetP = Ret*100)
tabla_m <- df_m %>% group_by(A√±o, Mes) %>% summarise(RetP = mean(RetP, na.rm = TRUE))
ggplot(tabla_m, aes(x = Mes, y = factor(A√±o), fill = RetP)) +
  geom_tile(color = "white") +
  scale_fill_viridis_c(option = "C", direction = 1, name = "Ret (%)") +
  labs(title = "Heatmap Estacional Mensual (QQQ)") +
  theme_tesla()
```

El mapa de calor estacional ofrece una deconstrucci√≥n granular de la din√°mica temporal del QQQ, permitiendo identificar patrones de estacionalidad, inercia (momentum) y cambios de r√©gimen que quedan ocultos en las m√©tricas anualizadas. La visualizaci√≥n confirma que la trayectoria del activo no es aleatoria, sino que exhibe una marcada dependencia serial: los retornos positivos (tonos naranjas y amarillos) y negativos (tonos morados y azules) tienden a agruparse en bloques temporales definidos, validando visualmente la presencia de reg√≠menes de mercado persistentes (Jegadeesh & Titman, 1993).

El an√°lisis cronol√≥gico del gr√°fico corrobora la severidad de los eventos de cola discutidos previamente. El periodo 2000-2002 aparece dominado por una densa concentraci√≥n de celdas en tonos morados oscuros y azules profundos, representando ca√≠das mensuales que frecuentemente excedieron el -10% o -20%. Esta "mancha t√©rmica" visualiza la destrucci√≥n de valor sistem√°tica durante el estallido de la burbuja Dot-Com, donde la ausencia de meses de recuperaci√≥n sostenida ilustra la capitulaci√≥n total del sentimiento inversor. Similarmente, el a√±o 2008 exhibe un deterioro progresivo que culmina en un cuarto trimestre te√±ido de violeta intenso, coincidiendo con el cl√≠max de la Crisis Financiera y el pico de volatilidad detectado en el gr√°fico de rolling volatility.

En contraste, la d√©cada de 2010-2019 se manifiesta como un bloque predominantemente c√°lido (naranja), caracterizado por una notable consistencia en los retornos positivos mensuales. Esta fase visualiza la "d√©cada dorada" tecnol√≥gica impulsada por la pol√≠tica monetaria acomodaticia y la expansi√≥n de las plataformas digitales. Sin embargo, el heatmap revela anomal√≠as estacionales importantes, destacando el "Efecto Septiembre": al observar la columna del noveno mes, se aprecia una recurrencia de tonos oscuros (a√±os 2000, 2001, 2008, 2020, 2021, 2022). Este patr√≥n sugiere una debilidad estacional estructural en el sector tecnol√≥gico al cierre del tercer trimestre, consistente con la literatura sobre anomal√≠as de calendario y rebalanceo de portafolios institucionales (Thaler, 1987).

Finalmente, la din√°mica reciente (2020-2025) muestra una alternancia violenta de reg√≠menes. El a√±o 2020 inicia con el shock del COVID (morado en marzo) seguido de una recuperaci√≥n verde/amarilla agresiva; mientras que 2022 se presenta como un "tablero de ajedrez" dominado por la correcci√≥n de tasas, con meses de p√©rdidas severas (abril, junio, septiembre). La recuperaci√≥n de 2023 y 2024, visible en las franjas superiores naranjas, confirma la resiliencia del √≠ndice y su capacidad para retomar el momentum alcista tras periodos de ajuste, impulsado nuevamente por la concentraci√≥n en mega-caps de inteligencia artificial. En conjunto, el heatmap demuestra que el riesgo del QQQ no se distribuye uniformemente a lo largo del a√±o, sino que se concentra en ventanas espec√≠ficas de estr√©s y estacionalidad negativa.



```{r comparacion, echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
library(tidyquant)
library(tidyverse)
library(plotly)
tesla_pal <- list(
  primary = "#cc0000",
  secondary = "#000000",
  text_main = "#333333",
  text_gray = "#666666"
)
theme_tesla <- function() {
  theme_minimal(base_family = "Inter") +
    theme(
      plot.title = element_text(face = "bold", size = 16, color = tesla_pal$text_main),
      plot.subtitle = element_text(size = 11, color = tesla_pal$text_gray, margin = margin(b = 15)),
      legend.position = "none",
      panel.grid.minor = element_blank(),
      panel.grid.major.x = element_blank(),
      panel.grid.major.y = element_line(color = "#e5e5e5", linetype = "dashed"),
      axis.text = element_text(color = tesla_pal$text_gray),
      axis.title = element_text(color = tesla_pal$text_gray, size = 10)
    )
}

tickers <- c("QQQ", "SPY", "DIA", "IWM")
nombres_map <- c(
  "QQQ" = "QQQ (Nasdaq-100)",
  "SPY" = "SPY (S&P 500)",
  "DIA" = "DIA (Dow Jones)",
  "IWM" = "IWM (Small Caps)"
)

datos_comp <- tq_get(tickers, get = "stock.prices", from = "1999-05-01")
datos_norm <- datos_comp %>%
  group_by(symbol) %>%
  mutate(
    Retorno_Acum = (adjusted / first(adjusted)) - 1,
    Nombre = nombres_map[symbol]
  ) %>%
  ungroup()

colores_comp <- c(
  "QQQ" = tesla_pal$primary,   
  "SPY" = "#2c3e50",           
  "DIA" = "#7f8c8d",        
  "IWM" = "#f39c12"            
)

p_comp <- ggplot(datos_norm, aes(x = date, y = Retorno_Acum, color = symbol)) +
  geom_line(aes(size = symbol, alpha = symbol)) +
  
  scale_color_manual(values = colores_comp, labels = nombres_map) +
  scale_size_manual(values = c("QQQ" = 1.2, "SPY" = 0.6, "DIA" = 0.6, "IWM" = 0.6), guide="none") +
  scale_alpha_manual(values = c("QQQ" = 1, "SPY" = 0.7, "DIA" = 0.7, "IWM" = 0.6), guide="none") +
  
  scale_y_continuous(labels = scales::percent_format(accuracy = 1)) +
  
  labs(
    title = "QQQ vs El Mercado",
    subtitle = "Rendimiento acumulado comparativo (2010 - Presente)",
    x = "",
    y = "Retorno Acumulado"
  ) +
  theme_tesla()

plotly::ggplotly(p_comp, tooltip = c("x", "y", "colour")) %>%
  layout(
    legend = list(
      orientation = "h", 
      x = 0.5, 
      xanchor = "center",
      y = 1.05,
      title = list(text = "")
    ),
    hovermode = "x unified"
  ) %>%
  config(displayModeBar = FALSE)
```

```{r partiion, echo=TRUE, warning=FALSE, message=FALSE}
library(ggplot2)
library(dplyr)
library(xts)

datos_plot <- data.frame(
  Fecha = index(precios),
  Precio = as.numeric(precios)
)

fecha_corte <- as.Date("2022-10-07")  
fecha_chatgpt <- as.Date("2022-11-30") 

ggplot(datos_plot, aes(x = Fecha, y = Precio)) +
  geom_line(color = tesla_pal$text_gray, alpha = 0.5, size = 0.5) +
    geom_line(data = subset(datos_plot, Fecha >= fecha_corte), 
            aes(x = Fecha, y = Precio), 
            color = tesla_pal$primary, size = 1.2) +
  
  geom_vline(xintercept = as.numeric(fecha_chatgpt), 
             color = "#8e44ad", linetype = "dashed", size = 0.9) +

  annotate("text", x = fecha_chatgpt, y = 320, 
           label = "Lanzamiento\nChatGPT", 
           angle = 90, vjust = -0.8, color = "#8e44ad", fontface="bold") +
  
  labs(
    title = "Impacto del Lanzamiento de ChatGPT",
    subtitle = "El inicio de la tendencia alcista coincide con la aparici√≥n de la IA Generativa",
    x = "", y = "Precio QQQ"
  ) +
  theme_tesla()
```

```{r ias, echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE, fig.width=10, fig.height=6}
library(ggplot2)
library(dplyr)
library(lubridate)
library(ggrepel) 
data_cronologia <- data.frame(
  Hito = c(
    "ChatGPT (OpenAI)", 
    "DALL¬∑E 2", "Midjourney v3", "Stable Diffusion", 
    "Nuevo Bing", "Claude (Anthropic)", "GPT-4", "Copilot 365", 
    "Google I/O (AI)", "Llama 2", "Mistral 7B", "DALL¬∑E 3", 
    "Gemini 1.0/Ultra", "Sora (Video)", "Gemini Android", 
    "Claude 3", "Llama 3", "GPT-4o", "PCs Copilot+"
  ),
  Fecha = as.Date(c(
    "2022-11-30", 
    "2022-04-06", "2022-07-25", "2022-08-22", 
    "2023-02-07", "2023-03-14", "2023-03-14", "2023-03-16", 
    "2023-05-10", "2023-07-18", "2023-09-27", "2023-10-19", 
    "2023-12-06", "2024-02-15", "2024-02-08", 
    "2024-03-04", "2024-04-18", "2024-05-13", "2024-05-20"  
  )),
  Categoria = factor(c(
    "EL PUNTO DE INFLEXI√ìN",
    rep("üé® IMAGEN Y VIDEO", 3),
    "üîÑ INTEGRACI√ìN", "üìù TEXTO Y LLMs", "üìù TEXTO Y LLMs", "üîÑ INTEGRACI√ìN",
    "üîÑ INTEGRACI√ìN", "üìù TEXTO Y LLMs", "üìù TEXTO Y LLMs", "üé® IMAGEN Y VIDEO",
    "üìù TEXTO Y LLMs", "üé® IMAGEN Y VIDEO", "üîÑ INTEGRACI√ìN",
    "üìù TEXTO Y LLMs", "üìù TEXTO Y LLMs", "üìù TEXTO Y LLMs", "üîÑ INTEGRACI√ìN"
  ), levels = c("EL PUNTO DE INFLEXI√ìN", "üìù TEXTO Y LLMs", "üé® IMAGEN Y VIDEO", "üîÑ INTEGRACI√ìN")),
  
  Importancia = c(
    "Critico", 
    "Normal", "Normal", "Normal", 
    "Critico", "Normal", "Critico", "Normal",
    "Normal", "Normal", "Normal", "Normal",
    "Critico", "Critico", "Normal",
    "Normal", "Normal", "Critico", "Normal"
  )
)

colores_cat <- c(
  "EL PUNTO DE INFLEXI√ìN" = "#e17055", 
  "üìù TEXTO Y LLMs"       = "#00b894", 
  "üé® IMAGEN Y VIDEO"     = "#06b6d4", 
  "üîÑ INTEGRACI√ìN"        = "#a29bfe"  
)

ggplot(data_cronologia, aes(x = Fecha, y = Categoria, color = Categoria)) +
  geom_line(aes(group = Categoria), size = 1, alpha = 0.3) +
  geom_point(aes(size = Importancia), alpha = 0.9) +
  geom_text_repel(
    aes(label = Hito), 
    size = 3.5, 
    fontface = "bold", 
    box.padding = 0.5,
    point.padding = 0.3,
    force = 2,
    direction = "y",      
    nudge_y = 0.2,        
    segment.color = "grey80"
  ) +
  scale_size_manual(values = c("Critico" = 5, "Normal" = 3), guide = "none") +
  scale_color_manual(values = colores_cat) +
  scale_x_date(date_breaks = "4 months", date_labels = "%b %Y") +
  geom_vline(xintercept = as.Date("2022-10-07"), linetype="dashed", color="#636e72") +
  annotate("text", x = as.Date("2022-10-07"), y = 4.3, label = "Inicio", 
           angle = 90, vjust = -0.5, size = 3, color="#636e72") +
  labs(
    title = "Cronolog√≠a del Boom de la IA Generativa",
    subtitle = "Lanzamientos clave que definieron la tendencia (2022-2024)",
    x = "", y = ""
  ) +
  theme_tesla() +
  theme(
    legend.position = "none",
    axis.text.y = element_text(face = "bold", size = 10),
    panel.grid.major.y = element_line(linetype = "dotted") 
  )
```




# 3. Resultados del Modelo ARIMA

## 3.1 Evaluaci√≥n de Estacionariedad

[**PLACEHOLDER:** Documenta pruebas de estacionariedad KPSS y ADF. Interpreta resultados]



## 3.2 An√°lisis ACF y PACF

[**PLACEHOLDER:** Inserta gr√°ficos ACF y PACF. Analiza patrones de autocorrelaci√≥n]

```{r acf, echo=TRUE, eval=FALSE}
library(ggplot2)
ggtsdisplay(diff(datos_tesla$Close))
```

## 3.3 Selecci√≥n del Modelo

[**PLACEHOLDER:** Documenta par√°metros p, d, q seleccionados y justificaci√≥n]

| Par√°metro | Valor | Justificaci√≥n |
|:---|:--:|:---|
| p | [ ] | [Basado en PACF] |
| d | [ ] | [Basado en tests de estacionariedad] |
| q | [ ] | [Basado en ACF] |

## 3.4 Ajuste del Modelo

[**PLACEHOLDER:** Resumen del modelo ARIMA ajustado con coeficientes interpretados]



## 3.5 Diagn√≥stico de Residuos

[**PLACEHOLDER:** An√°lisis de residuos: gr√°ficos, pruebas de normalidad y autocorrelaci√≥n]

```{r residuos, echo=TRUE, eval=FALSE}
checkresiduals(fit)
```

## 3.6 Pron√≥sticos

[**PLACEHOLDER:** Pron√≥sticos para per√≠odos futuros con intervalos de confianza]

```{r forecast, echo=TRUE, eval=FALSE}
forecast_tesla <- forecast(fit, h=10)
autoplot(forecast_tesla)
```

---

# 4. Conclusiones

## 4.1 Hallazgos Principales

[**PLACEHOLDER:** Resumen de hallazgos principales del an√°lisis ARIMA]

## 4.2 Implicaciones Pr√°cticas

[**PLACEHOLDER:** Implicaciones de los pron√≥sticos para inversionistas y analistas de mercado]

## 4.3 Limitaciones del An√°lisis

[**PLACEHOLDER:** Limitaciones del modelo y aspectos no capturados]

## 4.4 Recomendaciones Futuras

[**PLACEHOLDER:** Sugerencias para mejoras y extensiones del an√°lisis]



```{=html}

<div style="
  margin-top: 80px;
  padding: 40px;
  background: linear-gradient(135deg, rgba(124, 58, 237, 0.15), rgba(6, 182, 212, 0.08));
  border: 2px solid rgba(124, 58, 237, 0.4);
  border-radius: 15px;
  border-top: 3px solid rgba(132, 204, 22, 0.8);
  text-align: center;
  color: #e0e6ed;
  font-size: 0.95em;
  line-height: 1.8;
  box-shadow: 0 8px 30px rgba(124, 58, 237, 0.2);
">
  <div style="margin-bottom: 20px; background: linear-gradient(135deg, #7c3aed, #06b6d4); -webkit-background-clip: text; -webkit-text-fill-color: transparent; font-weight: 700; font-size: 1.1em;">
    ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
  </div>
  
  <strong style="background: linear-gradient(135deg, #7c3aed, #06b6d4); -webkit-background-clip: text; -webkit-text-fill-color: transparent;">ASIGNATURA:</strong> Gesti√≥n de Datos<br>
  <strong style="background: linear-gradient(135deg, #7c3aed, #06b6d4); -webkit-background-clip: text; -webkit-text-fill-color: transparent;">PROFESOR:</strong> Orlando Joaqui-Barandica<br>
  <strong style="background: linear-gradient(135deg, #7c3aed, #06b6d4); -webkit-background-clip: text; -webkit-text-fill-color: transparent;">UNIVERSIDAD:</strong> Universidad del Valle<br>
  <strong style="background: linear-gradient(135deg, #7c3aed, #06b6d4); -webkit-background-clip: text; -webkit-text-fill-color: transparent;">FACULTAD:</strong> Facultad de Ingenier√≠a<br>
  <strong style="background: linear-gradient(135deg, #7c3aed, #06b6d4); -webkit-background-clip: text; -webkit-text-fill-color: transparent;">PROGRAMA:</strong> Ingenier√≠a Industrial<br>
  
  <div style="margin-top: 20px; padding-top: 20px; border-top: 1px solid rgba(124, 58, 237, 0.3);">
    <strong style="background: linear-gradient(135deg, #06b6d4, #84cc16); -webkit-background-clip: text; -webkit-text-fill-color: transparent;">ESTUDIANTE:</strong> Camilo<br>
    <strong style="background: linear-gradient(135deg, #06b6d4, #84cc16); -webkit-background-clip: text; -webkit-text-fill-color: transparent;">FECHA ENTREGA:</strong> <span id="fecha-entrega"></span><br>
    <strong style="background: linear-gradient(135deg, #06b6d4, #84cc16); -webkit-background-clip: text; -webkit-text-fill-color: transparent;">VERSI√ìN:</strong> 1.0<br>
  </div>
  
  <div style="margin-top: 20px; color: #94a3b8; font-size: 0.9em;">
    <em>Documento generado con R Markdown | Tema: Series de Tiempo y Pron√≥sticos ARIMA</em>
  </div>
  
  <div style="margin-top: 15px; background: linear-gradient(135deg, #7c3aed, #06b6d4); -webkit-background-clip: text; -webkit-text-fill-color: transparent; font-weight: 700;">
    ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
  </div>
</div>
```



